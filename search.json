[{"title":"æˆ‘æ¨èä½ åœ¨ Windows 10 ä¸Šå®‰è£…è¿™äº›åº”ç”¨","url":"/articles/2020/11/13/interesting-things/apps-on-windows/","content":"\nè¿™äº›ç¨‹åºä¸­, æœ‰å¾ˆå¤šéƒ½æ˜¯æˆ‘ç”¨äº†å‡ å¹´çš„, å®ƒä»¬éƒ½å¾ˆå®Œç¾. å…¶ä¸­ä¸ä¹ä¸ªäººå¼€å‘è€…å¼€å‘å’Œæ›´æ–°ç»´æŠ¤çš„è½¯ä»¶, å¸Œæœ›å¤§å®¶ç”¨çš„æ—¶å€™å¦‚æœè§‰å¾—å¥½ç”¨, å¯ä»¥æ¨èç»™å…¶ä»–äºº.\n\nå¯¹äºé«˜æ•ˆå·¥ä½œå’Œç”Ÿæ´»æ¥è¯´, è¿™äº›æ˜¯å¿…å¤‡ç¨‹åº:\n\n- [Everything](https://www.voidtools.com/downloads/)\n- [Snipaste](https://zh.snipaste.com/download.html)\n- [Myersplash](https://juniperphoton.net/myersplash/)\n- [Firefox](https://www.mozilla.org/en-US/firefox/new/)\n- [Microsoft To-Do](https://to-do.microsoft.com/tasks/)\n- [Simple Sticky Notes](https://www.simplestickynotes.com/)\n- [PowerToys](https://github.com/microsoft/PowerToys/releases/)\n- [OneNote](https://www.onenote.com/download)\n- [Remotely](https://app.remotely.one/Agents)\n\nè¿˜æœ‰ä¸€äº›æ™®é€šäººå¯èƒ½ç”¨ä¸ä¸Šçš„:\n\n- [chocolatey](https://chocolatey.org/install)\n- [Keycastow](https://chocolatey.org/packages/keycastow)\n- [OBS](https://obsproject.com/download)\n- [FFMpeg](https://ffmpeg.org/download.html)\n\nä¸€äº›æ™®é€šäººå‡ ä¹ä¸çŸ¥é“çš„:\n\n- [ClevoECView](https://github.com/SkyLandTW/ClevoECView)\n"},{"title":"Redis æ•°æ®ç±»å‹åŠåº”ç”¨","url":"/articles/2020/11/12/database/redis-points/","content":"\n## æ•°æ®ç±»å‹çš„æ¯”è¾ƒ\n\n| ç±»å‹   | åº•å±‚åŸç† | æ”¯æŒçš„æ•°æ®æ“ä½œ | è®¾ç½® | åº”ç”¨åœºæ™¯ |\n| ------ | -------- | -------------- | ---- | -------- |\n| key    |          |                |      |          |\n| string |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n|        |          |                |      |          |\n\n## ä¸€äº›å…¸å‹çš„åœºæ™¯åŠæ•°æ®ç±»å‹çš„é«˜çº§åº”ç”¨\n\n## ä¸å…¶ä»–å†…å­˜æ•°æ®åº“çš„å¯¹æ¯”\n"},{"title":"è®¾è®¡å¥å£®å’Œå¹‚ç­‰çš„ Web API","url":"/articles/2020/11/10/infrastructure/design-robust-web-api/","content":"\nç½‘ç»œå’ŒæœåŠ¡ç«¯çš„é—®é¢˜éƒ½ä¼šå¯¼è‡´ API å‡ºé”™, è§£å†³è¿™ä¸ªé—®é¢˜éœ€è¦éµå¾ª 3 ä¸ªåŸåˆ™:\n\n1. ç½‘ç»œæ•…éšœå, å®¢æˆ·ç«¯éœ€è¦é‡æ–°å‘é€è¯·æ±‚æ¥ä¿æŒä¸€è‡´æ€§\n2. å®¢æˆ·ç«¯å› ä¸ºç½‘ç»œæ•…éšœé‡æ–°å‘é€çš„è¯·æ±‚éœ€è¦ä¿æŒå¹‚ç­‰æ€§, ä¹Ÿå°±æ˜¯è¯´éœ€è¦å¸¦ä¸Šä¸€ä¸ªç”¨äºä¿æŒå¹‚ç­‰çš„ id\n   1. åœ¨ RESTful API ä¸­, PUT, GET, DELETE è¿™äº›åŠ¨è¯éƒ½å…·æœ‰å¹‚ç­‰æ€§\n   2. POST ä¸èƒ½ä¿æŒå¹‚ç­‰, å› æ­¤éœ€è¦ä½¿ç”¨ä¸€ä¸ªé”® id æ¥åŒºåˆ†è¯·æ±‚. è¿™ä¸ªé”®æ˜¯è¿™æ ·ç”¨çš„:\n      1. å¦‚æœå®¢æˆ·ç«¯è¿™ä¸€ä¾§åœ¨å‘è¯·æ±‚å‰å¤±è´¥äº†, é‡å‘åå¯¹äºæœåŠ¡ç«¯æ¥è¯´æ˜¯é€æ˜çš„, ä¸å­˜åœ¨ä»€ä¹ˆé—®é¢˜\n      2. å¦‚æœå®¢æˆ·ç«¯å‘è¯·æ±‚åˆ°æœåŠ¡ç«¯å, æœåŠ¡ç«¯å¤„ç†æ—¶å‡ºé”™äº†, é‚£ä¹ˆéœ€è¦æ•°æ®åº“å…·å¤‡ ACID ç‰¹æ€§, å°†å¤„ç†åŒ…è£…æˆäº‹åŠ¡å³å¯. å¤±è´¥äº†å°±æ ‡è®°è¯¥ id å¹¶è¿”å›é”™è¯¯.\n      3. å¦‚æœæœåŠ¡ç«¯äº‹åŠ¡å¤„ç†æˆåŠŸäº†, ä½†å“åº”æ²¡èƒ½åˆ°è¾¾å®¢æˆ·ç«¯, é‚£ä¹ˆå®¢æˆ·ç«¯ä¼šé‡å‘è¯·æ±‚, æœåŠ¡ç«¯åªéœ€è¦æ ¹æ® id å°†ç¼“å­˜çš„ç»“æœè¿”å›å³å¯\n3. åŒæ—¶, éœ€è¦é¿å…å®¢æˆ·ç«¯é‡æ–°å‘é€è¯·æ±‚çš„é¢‘ç‡, é¿å…è¯·æ±‚é˜»å¡.\n"},{"title":"åˆ©ç”¨ JSON Schema æ¥ä¿éšœæ•°æ®æµä¸­æ•°æ®çš„å®Œæ•´å’Œä¸€è‡´æ€§","url":"/articles/2020/11/03/infrastructure/sharing-json-schema/","content":"\nJSON Schema æ˜¯ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„æ•°æ®å®šä¹‰è§„èŒƒ, å¯ä»¥å…ˆçœ‹çœ‹å®˜æ–¹çš„æ–‡æ¡£: [What is a schema](https://json-schema.org/understanding-json-schema/about.html). åˆ©ç”¨ JSON Schema æˆ‘ä»¬å¯ä»¥åœ¨é¡¹ç›®éœ€æ±‚åˆ†æé˜¶æ®µç¡®å®šæ•°æ®æ ¼å¼, æ–¹ä¾¿ç»Ÿä¸€æ–‡æ¡£, ä¹Ÿå¯ä»¥åœ¨å…·ä½“é¡¹ç›®ä¸­ç”¨äºæ•°æ®æœ‰æ•ˆæ€§éªŒè¯, ç¡®ä¿æ•´ä¸ªæ•°æ®æµä¸­æ•°æ®çš„å®Œæ•´å’Œä¸€è‡´.\n\n## è®¾è®¡\n\nè®¾è®¡ JSON schema æœ‰ç‚¹ç±»ä¼¼äºè®¾è®¡ SQL æ•°æ®åº“ä¸­çš„æ•°æ®è¡¨, è®¾è®¡ SQL è¡¨æ—¶éœ€è¦éµå¾ª 3NF, è€Œåœ¨è®¾è®¡ JSON Schema æ—¶éœ€è¦éµå¾ªè¿™äº›åŸåˆ™:\n\n1. å¯ç»„ç»‡. å°†ä¸€ä¸ªä¸€ä¸ªå°çš„ schema æ¨¡å—ç»„ç»‡èµ·æ¥è·å¾—æ›´å¤æ‚çš„æ•°æ®ç»“æ„.\n2. å¯æ‰©å±•.\n3. å¯ç»´æŠ¤.\n\næˆ‘ä»¬å¯ä»¥å€ŸåŠ©ä¸€äº›å·¥å…·æ¥å®šä¹‰ Model ç±», ç„¶åé€šè¿‡ç±»çš„ç»§æ‰¿å’Œæ‰©å±•å®ç° Schema çš„ç»„ç»‡/æ‰©å±•. æ¯”å¦‚ Python ä¸­æœ‰ pydantic åŒ…å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°† Model å¯¼å‡ºæˆ JSON Schema.\n\n## ç®¡ç†å’Œåº”ç”¨\n\nåœ¨å­˜å‚¨ Schema æ—¶ä¹Ÿä¸å¿…ç”¨ JSON æ ¼å¼, JSON, TOML, YAML ç”šè‡³ python ä»£ç éƒ½æ˜¯å¯ä»¥ç›¸äº’ç¿»è¯‘è½¬æ¢çš„, å°½é‡ä½¿ç”¨é€‚åˆå·²æœ‰ç³»ç»Ÿçš„, æ›´å¯è¯»çš„æ–¹å¼å­˜å‚¨ Schema.\n\nå°† JSON schema å‘å¸ƒåˆ°æ³¨å†Œè¡¨æœåŠ¡å¹¶åˆ†é…ä¸€ä¸ª id, å¹¶åœ¨æ•°æ®å‘é€æ—¶å¸¦ä¸Š id, åœ¨æ•°æ®æ¶ˆè´¹æ—¶é€šè¿‡ schema id è¿›è¡Œæ•°æ®æ ¡éªŒ. é€šè¿‡ NACOS å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°è¿™ä¸ªåŠŸèƒ½:\n\n![json schema](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20201103100021.png)\n\nä¹Ÿå¯ä»¥é€šè¿‡å…¶ä»–çš„æ•°æ®åº“è¿›è¡Œå­˜å‚¨, æ¯”å¦‚ redis/MySQL/mongoDB ç­‰ç­‰.\n\n## å®è·µ\n\n1. é€šè¿‡ python ä»£ç å®šä¹‰ model\n2. é€šè¿‡ model åŠ¨æ€ç”Ÿæˆ schema\n3. åœ¨ CI/CD ä¸­éƒ¨ç½² schema åˆ° NACOS\n4. åœ¨ schema åˆ†ç»„æ—¶, å¯ä»¥å‚è€ƒ redis çš„é”®çš„è®¾ç½®.\n5. åœ¨å‘é€æ•°æ®æ—¶åœ¨æ•°æ®ä¸­å¸¦ä¸Š schema id\n6. åœ¨æ¶ˆè´¹æ•°æ®æ—¶æ ¹æ® schema id éªŒè¯æ•°æ®\n"},{"title":"Weekly Update, 10 27, 20","url":"/articles/2020/10/27/weekly-update/20201027/","content":"\n### Work\n\n- Fix performance issues when using python I/O.\n\n### TWIL\n\nThis week I learn:\n\n- tmux & vim\n- Clojure concurrency model\n\n### To be done in next week\n\n- Golang in action\n- LeetCode 10\n- Dissertation researc proposal\n\n### Things Can Be Improved\n\n- More sports, less sugar.\n"},{"title":"Weekly Update, 10 16, 20","url":"/articles/2020/10/16/weekly-update/20201016/","content":"\n### Work\n\n- A python project, watch DBF files then push data to Kafka.\n  - Existing DBF packages cannot handle column missing issue thus will extract wrong data. I work around this by reading bytes according to pre-defined rules.\n\n### TWIL\n\nThis week I learn:\n\n- I read {seven concurrency models in seven weeks}\n\n### To be done in next week\n\n- LeetCode\n- Read source code of `asyncio`\n\n### Things Can Be Improved\n\n- Less LOL\n- More sleep\n"},{"title":"Weekly Update, 09 27, 20","url":"/articles/2020/09/27/weekly-update/200927/","content":"\nThis is the 1st post in category `weekly-update`, my goal is to become financial dependent, hope I can scrum it successfully!\n\n### Work\n\n- A study and test of Level-2 quote api of A-Share market:\n  - Tonghuashun\n  - East Money\n  - Sina\n  - CSMA\n  - etc.\n- A study and test of real time transaction api of A-Share market:\n  - CATS\n\n### To be done in next week\n\n- Establish an private NTP server\n- A project to get real time account information and positions\n- Dive deep into concurrent programming with book `Seven Concurrency Models in Seven Weeks`\n- Re-Read book `Introduction to Algorithms`\n\n### Things Can Be Improved\n\n- Spend more time on books\n"},{"title":"Ansibleï¼š è€é¡¹ç›® Devops æ•‘æ˜Ÿ","url":"/articles/2020/07/10/cicd/ansible-in-action/","content":"\næ³¨ï¼šæœ¬æ–‡é¦–å‘äº`æ­¦å¤§NLPå®éªŒå®¤`å…¬ä¼—å·ï¼ŒIDï¼š`WHU_NLP`ï¼Œæ¬¢è¿å…³æ³¨ï¼\n\n## ç—›ç‚¹\n\nå®éªŒå®¤æœåŠ¡å™¨æ•°é‡çš„å¢å¤šè®©åŸºç¡€è®¾æ–½å˜å¾—æ›´åŠ å¤æ‚ï¼Œå½“éœ€è¦æ›´æ–°ä¸€äº›å®éªŒå’Œé¡¹ç›®æ‰€ä¾èµ–çš„åŸºç¡€ç¯å¢ƒæ—¶çš„ä½ ï¼š\n\n![ç¯å¢ƒé…ç½®1](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702103555.png)\n\næ­¤å¤–ï¼Œæ¨ªè·¨å‡ å±Šçš„è€é¡¹ç›®çš„éƒ¨ç½²å’Œç»´æŠ¤å·²ç»æˆä¸ºäº†å¼€å‘äººå‘˜çš„å™©æ¢¦ï¼Œå¦‚æœæ–‡æ¡£ä¸å¥å…¨ï¼Œåœ¨æ›´æ–°éƒ¨ç½²æ—¶å¯èƒ½éœ€è¦ä¸€å¤©çš„æ—¶é—´ï¼Œè€Œæ–‡æ¡£å¥å…¨æ—¶çš„æƒ…å†µä¼šå¥½ä¸€äº›ï¼Œåªéœ€è¦ 24 ä¸ªå°æ—¶ï¼š\n\n<img src=\"https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702002712.png\" alt=\"ç¯å¢ƒç®¡ç†\" style=\"zoom:70%;\" />\n\nå¹¶ä¸”ï¼Œåœ¨å¤šäººå…±äº«æœåŠ¡å™¨æ—¶ï¼Œæƒé™æ§åˆ¶ä¹Ÿå¾ˆéº»çƒ¦ã€‚ä¸ºäº†é¿å…æŸä½æœ‰ root æƒé™çš„ç”¨æˆ·çš„è¯¯æ“ä½œå¦‚æ¸…ç†äº†æŸäº›ç›®å½•æˆ–è€…åœæ­¢äº†æŸäº›æ ¸å¿ƒè¿›ç¨‹è€Œå¯¼è‡´æœåŠ¡å™¨è¿è¡Œå¼‚å¸¸ï¼Œç®¡ç†å‘˜å¾€å¾€åªç»™ç”¨æˆ·æ™®é€šæƒé™ï¼Œè€Œè¿™æ ·ä¸€åˆ€åˆ‡çš„å¤„ç†æ–¹å¼åˆä¼šä½¿ç®¡ç†å‘˜é¢‘ç¹åœ°å› ä¸º root æƒé™ç”³è¯·è¢«æ‰“æ‰°ã€‚\n\n![æƒé™ç®¡ç†](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702002732.png)\n\n## å¯èƒ½çš„è§£å†³æ–¹æ³•\n\né‚£ä¹ˆæœ‰ä»€ä¹ˆåŠæ³•æ¥è§£å†³ä¸Šé¢çš„è¿™äº›é—®é¢˜å‘¢ï¼Ÿæ‰‹åŠ¨è¿è¡Œå‘½ä»¤å¯èƒ½æ˜¯å¯¹åŸºç¡€è®¾æ–½è¿›è¡Œç»´æŠ¤æœ€ç›´æ¥çš„æ–¹æ³•ï¼Œä½†æ•ˆç‡å®åœ¨å¤ªä½ï¼Œè€Œä¸”å¤±è¯¯çš„æ¦‚ç‡è¾ƒå¤§ã€‚\n\n![image-20200702105941121](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702105941.png)\n\né’ˆå¯¹å…·ä½“ä»»åŠ¡ç¼–å†™å°è„šæœ¬ä¼¼ä¹ä¼šæ•ˆç‡æ›´é«˜ï¼Œä½†è°ƒè¯•çš„è¿‡ç¨‹å¯èƒ½ä¼šæ¯”è¾ƒç—›è‹¦ï¼Œæ‰©å±•æ€§ã€å®‰å…¨æ€§ã€å¯è¯»æ€§å‡æ¯”è¾ƒå·®ï¼Œè€Œä¸”è¿è¡Œè®°å½•éš¾ä»¥è¿½è¸ªã€è¿è¡Œåéš¾ä»¥å›æº¯ã€‚\n\n![image-20200702003352104](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702003352.png)\n\né‚£ä¹ˆæœ‰æ²¡æœ‰ä¸€ç§ç®€å•è§£å†³ä¸Šè¿°é—®é¢˜çš„æ–¹æ³•å‘¢ï¼Ÿ\n\n## åŸºç¡€è®¾æ–½/æ¶æ„å³ä»£ç (Infrastructure as Code)\n\n![Infrastructure as code defines the environment in a versioned file](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703111856.png)\n\nInfrastructure as Code ç®€ç§° IaCï¼Œæ˜¯ DevOps çš„ä¸€é¡¹é‡è¦å®è·µï¼Œå…·ä½“å°±æ˜¯ç”¨ä¸€ç§æè¿°æ€§çš„(declarative)æ¨¡å‹æ¥ç®¡ç†åŸºç¡€è®¾æ–½ï¼Œæ¯”å¦‚ç½‘ç»œã€æœåŠ¡å™¨ã€è™šæ‹Ÿæœºã€è´Ÿè½½å¹³è¡¡å™¨åŠä»–ä»¬çš„æ‹“æ‰‘ç»“æ„ç­‰èµ„æºã€‚IaC çš„é‡è¦åŸåˆ™æ˜¯å¹‚ç­‰æ€§ï¼Œå¯¹äºä¸€å¥—å›ºå®šçš„åŸºç¡€è®¾æ–½ï¼Œç›¸åŒçš„æè¿°æ€§çš„é…ç½®æ€»ä¼šè®©åŸºç¡€è®¾æ–½è¿›å…¥åˆ°ä¸€ä¸ªç›¸åŒçš„çŠ¶æ€ã€‚è¿™ç§å¹‚ç­‰æ€§è®©åŸºç¡€è®¾æ–½çš„çŠ¶æ€å¯å¤åˆ¶ã€å¯æ‰©å±•ã€å¯è¿½è¸ªå¹¶ä¸”å¯å›æº¯ã€‚IaC é€šå¸¸å’ŒæŒç»­äº¤ä»˜ç»“åˆä½¿ç”¨ã€‚\n\nIaC å®è·µä¸­é€šå¸¸ä½¿ç”¨ä¸€ç§æè¿°æ€§çš„ç¼–ç è¯­è¨€ï¼Œå¦‚ JSON, YAML, XML ç­‰ï¼Œè¿™äº›è¯­è¨€å¤§å¤šç®€å•æ˜“å­¦ï¼Œä¸”å…·å¤‡è‰¯å¥½çš„å¯è¯»æ€§ã€‚ä¸‹é¢è¿™æ®µ YAML ä»£ç æ‰€æè¿°çš„å†…å®¹å’Œ MarkDown ååˆ†ç±»ä¼¼ï¼Œç›¸ä¿¡ä¸æ˜¯ç¨‹åºå‘˜ä¹Ÿèƒ½ç†è§£å…¶å«ä¹‰ã€‚\n\n```yaml\n# Employee records\n- martin:\n    name: Martin D'vloper\n    job: Developer\n    skills:\n      - python\n      - perl\n      - pascal\n- tabitha:\n    name: Tabitha Bitumen\n    job: Developer\n    skills:\n      - lisp\n      - fortran\n      - erlang\n```\n\n### å¯ç”¨æ–¹æ¡ˆå¯¹æ¯”\n\nIaC å‘å±•å·²ä¹…ï¼Œç›®å‰æœ‰è®¸å¤šå¯ç”¨æ–¹æ¡ˆã€‚\n\n![IaC æ–¹æ¡ˆå¯¹æ¯”](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703115355.png)\n\né€šè¿‡ä»æ˜“ç”¨æ€§ã€æ‰©å±•æ€§å’Œä»·æ ¼ç­‰ç»´åº¦å¯¹æ¯”å·²æœ‰çš„ IaC æ–¹æ¡ˆï¼Œæˆ‘ä»¬å‘ç° Ansible æ˜¯ä¸€ä¸ªæ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒAnsible ç›¸æ¯”äºå…¶ä»–çš„é¡¹ç›®ï¼Œè¿˜æœ‰ä¸€é¡¹æœ€é‡è¦çš„ç‰¹ç‚¹ï¼Œåœ¨äº Agentlessï¼Œå³æ— å®¢æˆ·ç«¯/æ— ä»£ç†çš„è¿è¡Œæ¨¡å¼ã€‚\n\n### Ansibleï¼šå¼€æºçš„åŸºç¡€è®¾æ–½å³ä»£ç è§£å†³æ–¹æ¡ˆ\n\n![image-20200703120008312](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703120008.png)\n\nAnsible çš„ç¬¬ä¸€ä¸ªç‰ˆæœ¬å‘å¸ƒäº 2012 å¹´ 2 æœˆï¼Œè‡³ä»Šå·²ç»è¿­ä»£äº†å¾ˆé•¿æ—¶é—´ã€‚\n\nAnsible åŸºäºçº¯æ–‡æœ¬ YAML æ–‡ä»¶æ¥æè¿°èµ„æºçš„è¡Œä¸ºã€çŠ¶æ€æˆ–è€…ç‰¹å®šä»»åŠ¡ï¼Œå‡ ä¹æ‰€æœ‰åœ°æ–¹éƒ½æ”¯æŒè®¾ç½®å˜é‡ï¼ŒåŒ…æ‹¬ playbookã€æ–‡ä»¶ã€inventoryã€å‘½ä»¤ã€ä»å—æ§ä¸»æœºä¼ å›çš„å˜é‡ç­‰ã€‚ä½¿ç”¨ Ansible çš„é¡¹ç›®å…·æœ‰é«˜å¯è¯»æ€§ï¼ˆäºº & è®¡ç®—æœºï¼‰ã€‚\n\nç®€å•æ¥è¯´ï¼Œå®ƒå…·æœ‰è¿™äº›ç‰¹ç‚¹ï¼š\n\n- ç®€å• ğŸ‘´\n  - åŸºäº yamlï¼Œé«˜å¯è¯»æ€§\n  - ä¸éœ€è¦ç‰¹å®šçš„å¼€å‘æŠ€èƒ½\n  - åŸºäºå·²æœ‰çš„ç¤¾åŒºè½®å­å¿«é€Ÿéƒ¨ç½²\n- å¼ºå¤§ ğŸ‘\n  - åº”ç”¨éƒ¨ç½²\n  - é…ç½®ç®¡ç†\n  - å®šåˆ¶å·¥ä½œæµ\n  - ç®¡ç†åº”ç”¨çš„ç”Ÿå‘½å‘¨æœŸ\n- æ— ä»£ç† ğŸ‘\n  - æ— ä»£ç†æ¶æ„\n  - åŸºäº OpenSSH & WRM(è¿œç¨‹ Powershell)\n  - æ— éœ€æ›´æ–°é…ç½®\n  - æ›´å®‰å…¨å¯é ã€æ›´é«˜æ•ˆ\n\n### Ansible æ¶æ„\n\n![img](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702003725.png)\n\nAnsible æ¶æ„ç®€å•ç›´æ¥ï¼ŒInventory ä»£è¡¨å—ç®¡ç†çš„èŠ‚ç‚¹æˆ–å…¶ä»–èµ„æºï¼Œç”¨æˆ·åœ¨å»ºç«‹æ§åˆ¶èŠ‚ç‚¹åˆ°å—æ§èŠ‚ç‚¹çš„è¿æ¥åï¼Œé€šè¿‡ç›´æ¥æŒ‡å®šå‘½ä»¤æˆ–ç¼–å†™ä¸€ç§å«åš Playbook çš„é…ç½®æ–‡ä»¶æ¥æ‰§è¡Œç‰¹å®šçš„ä»»åŠ¡ã€‚å¯¹äº Linux èŠ‚ç‚¹ï¼Œä½¿ç”¨ SSH å»ºç«‹è¿æ¥ï¼›è€Œå¯¹äº Windows èŠ‚ç‚¹ï¼Œåˆ™ä½¿ç”¨ WRM(Windows Remote Management) æœåŠ¡ã€‚\n\n### Ansible å¯¹è±¡\n\nåœ¨ Ansible ä¸­ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šç”¨åˆ°è¿™äº›å¯¹è±¡ï¼š\n\n- Inventoryï¼šå—æ§èµ„æºï¼Œå¦‚ä¸»æœº\n- Modulesï¼šé¢„å®šä¹‰ä¸”å¯æ‰©å±•çš„ç”¨äºæ‰§è¡Œç‰¹å®šä»»åŠ¡çš„æ¨¡å—\n- Tasksï¼šç”¨æˆ·æè¿°çš„ç‰¹å®šçš„ä»»åŠ¡\n- Playbooksï¼šç”¨æˆ·æè¿°çš„ç‰¹å®šä»»åŠ¡é›†ï¼Œæè¿°ä¸€ç³»åˆ—ç‰¹å®šçš„ä»»åŠ¡åŠé…å¥—è¡Œä¸º\n\n![image-20200703122053922](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703122054.png)\n\næ­¤å¤–ï¼ŒAnsible è¿˜æœ‰ä¸€ä¸ªç±»ä¼¼äº GitHub çš„ç¤¾åŒºï¼Œå« Ansible Galaxyã€‚åœ¨è¿™ä¸ªç¤¾åŒºä¸­ï¼Œæœ‰å¤§é‡ç¤¾åŒºæˆå‘˜é¢„å®šä¹‰çš„è§£å†³ç‰¹å®šä»»åŠ¡çš„å·¥å…·åŒ…ï¼Œæˆ‘ä»¬æ—¢å¯ä»¥ç›´æ¥ä¸‹è½½ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å°†åˆé€‚çš„å·¥å…·åŒ…é›†æˆåˆ°è‡ªæœ‰çš„ Playbooks ä¸­ã€‚\n\n## åœ¨å®éªŒå®¤çš„åº”ç”¨æ¡ˆä¾‹\n\n### éœ€æ±‚èƒŒæ™¯\n\nå®éªŒå®¤ä¸­æœ‰è®¸å¤šçš„è€é¡¹ç›®ï¼Œè¿™äº›é¡¹ç›®çš„æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒå°šæœªåˆ†ç¦»ï¼Œæµ‹è¯•ä¾èµ–äº Monkey Testï¼›éƒ¨ç½²å’Œè¿è¡Œä¾èµ–äºç‰¹å®šçš„è¿è¡Œç¯å¢ƒï¼Œä¸”éœ€è¦å¤§é‡çš„æ‰‹å·¥æ“ä½œï¼ŒæˆåŠŸç‡è¾ƒä½ã€‚\n\nè¿ç§»è¿™äº›è€é¡¹ç›®åˆ°æ–°çš„ Kubernetes é›†ç¾¤çš„å¼€å‘æˆæœ¬è¾ƒé«˜ï¼Œå› æ­¤æˆ‘ä»¬å¸Œæœ›å€ŸåŠ©äº Ansible æ¥è§£å†³è¿™äº›é—®é¢˜ï¼Œå®ç°è¿™äº›åŠŸèƒ½ï¼š\n\n- æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒåˆ†ç¦»\n- æ—§é¡¹ç›®ä¾èµ–çš„ç‰ˆæœ¬æ§åˆ¶\n- æƒé™æ§åˆ¶\n- ä¸åŒä¾èµ–ä¹‹é—´ç¯å¢ƒéš”ç¦»\n- å¯è¿½è¸ªã€å›æº¯ã€æ‰©å±•\n- è‡ªåŠ¨éƒ¨ç½²\n\n### å…·ä½“åº”ç”¨\n\nå¯¹äºæ—§é¡¹ç›®ï¼Œåœ¨åšæŒé‡‡ç”¨è§„èŒƒçš„å¼€å‘æµç¨‹çš„å‰æä¸‹ï¼Œä¸€ä¸ªæ–°çš„ Feature ä»ç¬¬ä¸€ä¸ª MRï¼ˆMerge Request åˆå¹¶è¯·æ±‚ï¼‰ åˆ°æˆåŠŸä¸Šçº¿åœ¨æ—¶åºå›¾ä¸­éœ€è¦è¶…è¿‡ 30 æ­¥çš„æ“ä½œã€‚è¿™æ ·çš„æµç¨‹è¿‡åº¦ä¾èµ–äººå·¥ï¼Œä¸åŒçš„ç¯å¢ƒä¾èµ–äºä¸åŒçš„ GitLab Runnerï¼Œè€Œ Runner çš„è®¾ç½®ä¸å…·ä½“é¡¹ç›®è€¦åˆï¼Œé¢‘ç¹æ›´æ”¹å•ä¸ªé¡¹ç›®çš„ Runner å®¹æ˜“å‡ºé”™ï¼Œè€Œä¸ºæµ‹è¯•å’Œç”Ÿäº§é¡¹ç›®è®¾ç½®ä¸åŒçš„ Runner åˆ™ä¼šå¾’å¢è®¸å¤šé‡å¤çš„é¡¹ç›®ï¼Œè¡ç”Ÿå‡ºè®¸å¤šå…¶ä»–çš„é—®é¢˜ã€‚\n\n![image-20200702004157733](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200702004157.png)\n\nå› æ­¤ï¼Œæˆ‘ä»¬å°† GitLab CI å’Œ Ansible ç»“åˆã€‚å…·ä½“æ¥è¯´åŒ…å«è¿™äº›å…³é”®æ­¥éª¤ï¼š\n\n- å‡†å¤‡å¤šå°ä¸»æœºï¼ˆè™šæ‹Ÿï¼‰ï¼Œå¹¶æ·»åŠ åˆ° Ansible Inventory ä¸­\n- åœ¨ GitLab åˆ›å»ºä¸€ä¸ªç”¨äºç®¡ç†æ—§é¡¹ç›®åŸºç¡€æ¶æ„çš„é¡¹ç›®ï¼Œå¹¶æŒ‡å®š Runner ä¸º Ansible æ§åˆ¶èŠ‚ç‚¹\n- åœ¨ Ansible é¡¹ç›®ä¸­ï¼Œä¸ºç”Ÿäº§ç¯å¢ƒå’Œæµ‹è¯•ç¯å¢ƒæŒ‡å®šä¸åŒçš„ Inventoryï¼Œåˆ›å»º Playbook å®šä¹‰æ—§é¡¹ç›®æ„å»ºã€éƒ¨ç½²ã€æµ‹è¯•ä»»åŠ¡çš„å…·ä½“è¡Œä¸ºã€çŠ¶æ€å’Œä¾èµ–çš„ç¯å¢ƒ\n- å®šä¹‰ GitLab CI æµæ°´çº¿ï¼Œé…ç½®æŒç»­é›†æˆå’ŒæŒç»­éƒ¨ç½²\n\né€šè¿‡è¿™äº›å…³é”®æ­¥éª¤ï¼Œæˆ‘ä»¬å®ç°äº†é¢„æœŸçš„åŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼š\n\n1. é¡¹ç›®å¼€å‘è€…æäº¤ä»£ç åè§¦å‘ GitLab æµæ°´çº¿ï¼ŒAnsible æ§åˆ¶èŠ‚ç‚¹ä¼šè¿è¡Œ Playbook ä¸­å®šä¹‰çš„è¡Œä¸ºï¼Œåœ¨æµ‹è¯•ç¯å¢ƒä¸­æ›´æ–°ä¾èµ–å¹¶è¿è¡Œæµ‹è¯•ä»»åŠ¡\n2. åœ¨ MR é€šè¿‡å Ansible æ§åˆ¶èŠ‚ç‚¹è‡ªåŠ¨åœ¨é¢„å‘å¸ƒ(Staging)ç¯å¢ƒä¸­éƒ¨ç½²\n3. é¡¹ç›®ç®¡ç†è€…ç¡®è®¤ Staging ç¯å¢ƒä¸­åŠŸèƒ½æ­£å¸¸åï¼Œç‚¹å‡» GitLab æµæ°´çº¿çš„æ‰‹åŠ¨æ“ä½œå³å¯æŒ‰ç…§è®¾å®šæ¯”ä¾‹ 10%ï¼Œ50%ï¼Œ100% ç­‰æ›´æ–°ç”Ÿäº§ç¯å¢ƒã€‚\n\nä¸‹å›¾æ˜¯æˆ‘ä»¬ Ansible é¡¹ç›®ä¸­çš„å…·ä½“æ–‡ä»¶ï¼Œå…¶ä¸­ `.gitlab-ci.yml` æ˜¯ GitLab CI æµæ°´çº¿é…ç½®æ–‡ä»¶ï¼Œè€Œ `build.yaml`, `test.yaml` å’Œ `deploy.yaml` åˆ™æ˜¯ Ansible Playbook æ–‡ä»¶ã€‚é€šè¿‡å°†é¡¹ç›®çš„ä¾èµ–å’Œè¡Œä¸ºæè¿°æˆ YAML æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†ä¾èµ–ã€ç¯å¢ƒã€è¡Œä¸ºçš„æ›´æ–°è½¬åŒ–æˆå¯¹ä»£ç ä»“åº“çš„ä¸€æ¬¡ MRã€‚\n\n![image-20200703125905619](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703125905.png)\n\nä¸‹å›¾æ˜¯æµæ°´çº¿è¿è¡Œçš„æˆªå›¾ï¼Œå…¶ä¸­ `deploy` æ˜¯æ‰‹åŠ¨æ“ä½œï¼Œç”¨äºå°†é¡¹ç›®éƒ¨ç½²åˆ° `staging` ç¯å¢ƒã€‚\n\n![image-20200703125803430](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703125803.png)\n\n### æ•ˆæœå¯¹æ¯”\n\næŸä¸æ„¿é€éœ²å§“åçš„é¡¹ç›®ç»„æˆå‘˜è¡¨ç¤ºï¼Œå¯¹äºæ—§é¡¹ç›®çš„æ›´æ–°å’Œéƒ¨ç½²ï¼Œå†ä¹Ÿä¸ç”¨æ‹…å¿ƒç§ƒå¤´äº†ã€‚\n\n![image-20200703123501733](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20200703123501.png)\n\n### Ansible æœ€ä½³å®è·µæŒ‡å—\n\næ ¹æ®æˆ‘ä»¬çš„å¼€å‘ç»éªŒå’Œ Ansible å®˜æ–¹æŒ‡å—ï¼Œæˆ‘ä»¬è®¤ä¸ºåŸºäº Ansible å¼€å‘éœ€è¦éµå¾ªä»¥ä¸‹åŸåˆ™ï¼š\n\n- ä»£ç è¶Šå¤æ‚ï¼Œç”Ÿäº§æ•ˆç‡è¶Šä½\n- æé«˜ Playbook ä¸­çš„ä»»åŠ¡å’Œå˜é‡å®šä¹‰çš„å¯è¯»æ€§\n- ä¾æ®å£°æ˜å¼çš„æ€æƒ³ç¼–å†™ Playbook æ–‡ä»¶ï¼ŒPlaybook ä¸æ˜¯ Coding\n- è¯·ä¸º Ansible Playbook ç¼–å†™å•å…ƒæµ‹è¯•\n\n### Ansible çš„å±€é™\n\næˆ‘ä»¬ä¹Ÿå‘ç°äº† Ansible çš„ä¸€äº›å±€é™ï¼Œä¸»è¦æ˜¯ï¼š\n\n1. Ansible æ¯”è¾ƒé€‚åˆéƒ¨ç½²è€çš„é¡¹ç›®ï¼Œæ–°çš„é¡¹ç›®ä¸å»ºè®®ä½¿ç”¨ï¼Œè¯·ç›´æ¥ä¸Š Kubernetes è°¢è°¢ã€‚\n2. Ansible ä¸æ”¯æŒæœåŠ¡çš„åº•å±‚ç¯å¢ƒéš”ç¦»ï¼Œå¦‚ç½‘ç»œã€ç³»ç»Ÿå†…æ ¸ç‰ˆæœ¬ç­‰ã€‚\n3. Ansible çš„å“åº”é€Ÿåº¦ä¸è¡Œï¼Œå°¤å…¶æ˜¯æ–‡ä»¶ä¼ è¾“é€Ÿåº¦å¤ªæ…¢ï¼ˆå¦‚æœæ— æ³•å¿å—ï¼Œå¯ä»¥è‡ªå·±å†™ Moduleï¼Œæ ¹æ®ç‰¹å®šä¸šåŠ¡éœ€æ±‚æ‰©å±•æ–‡ä»¶ä¼ è¾“ç®—æ³•ï¼Œä½¿ç”¨æ–‡ä»¶åˆ†å—ç®—æ³•ç­‰æ–¹å¼ï¼‰\n\nå¯¹äºæ–°é¡¹ç›®çš„æ›´ä¼˜çš„é€‰æ‹©ï¼šä»¥ Kubernetes, OpenStack, Openshift ä¸ºä»£è¡¨çš„æœåŠ¡ç¼–æ’å¹³å°ï¼Œæ”¯æŒæ“ä½œç³»ç»Ÿå³ä»£ç ã€æœåŠ¡ç¼–æ’ã€ç½‘ç»œéš”ç¦»ç­‰é«˜çº§ç‰¹æ€§ã€‚\n\n### æ•ˆæœä¸å±•æœ›\n\nå®éªŒå®¤çš„å¤§å¤šæ•°é¡¹ç›®å·²ç»éƒ¨ç½²åœ¨äº† Kubernetes ä¸Šï¼Œå¯¹äºè€é¡¹ç›®è€Œè¨€ï¼ŒAnsible æ— ç–‘æ˜¯æœ€ä½³é€‰æ‹©ã€‚é€šå¸¸ï¼Œå®éªŒå®¤ä¸­ä¸€ä¸ªé¡¹ç›®ç»„ä½¿ç”¨äº† Ansible åï¼Œå…¶ä»–é¡¹ç›®ç»„ä¹Ÿå¯ä»¥å‚è€ƒå·²æœ‰çš„å†™æ³•å¿«é€Ÿå®ç°å®ç°è‡ªå·±é¡¹ç›®çš„è‡ªåŠ¨åŒ–éƒ¨ç½²ã€‚\n\nå®‰å…¨æ€§ã€å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å’Œæ˜“ç”¨æ€§æ˜¯æˆ‘ä»¬çš„è¿½æ±‚ï¼Œç›¸ä¿¡éšç€ DevOps æŠ€æœ¯çš„å‘å±•ï¼Œæœªæ¥æˆ‘ä»¬å¯ä»¥ä¸ºå®éªŒå®¤é¡¹ç›®æˆå‘˜æä¾›æ›´å¥½çš„ DevOps ä½“éªŒã€‚\n\n## å‚è€ƒèµ„æ–™\n\n> - Infrastructure as Code: https://en.wikipedia.org/wiki/Infrastructure_as_code\n> - Ansible Repository: https://github.com/ansible\n> - YAML language spec: https://yaml.org/spec/1.2/spec.html\n> - Ansible official documentation: https://docs.ansible.com/\n> - Ansible Galaxy: http://galaxy.ansible.com/\n> - Ansible Module Index: https://docs.ansible.com/ansible/latest/modules/modules_by_category.html\n> - GitLab CI official documentation: https://docs.gitlab.com/ce/ci/\n> - YAML Syntax: https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html\n> - Ansible Best Practices ANSIBLE BEST PRACTICES: THE ESSENTIALS\n"},{"title":"Secret & Config in K8s and Helm","url":"/articles/2020/06/29/kubernetes/secret-config-in-k8s/","content":"\n- Secret åœ¨ helm ä¸­å¯ä»¥å¾ˆæ–¹ä¾¿åœ°é€šè¿‡ template æ¥å®šä¹‰ï¼Œå¹¶ä¼šè‡ªåŠ¨åˆ›å»ºåˆ°å¯¹åº”å‘½åç©ºé—´\n- å¯ä»¥å°† secret ä½œä¸º volume æŒ‚è½½åˆ° pod\n- æŒ‚è½½çš„åœ°å€ä¸èƒ½æ˜¯ / æ ¹ç›®å½•ï¼Œå¦åˆ™ä¼šå°†å®¹å™¨çš„æ ¹ç›®å½•éƒ½è®¾ç½®æˆè™šæ‹ŸåŒ–çš„ç›®å½•\n- å¯ä»¥æ ¹æ®éœ€è¦ï¼Œå°† secret ä¸­çš„å¯¹åº”çš„ key æ˜ å°„åˆ°å…·ä½“çš„æ–‡ä»¶å\n"},{"title":"Advance in Kubernetes (1)","url":"/articles/2020/06/20/kubernetes/focal-points-in-k8s/","content":"\n## ä¿®å¤ RethinkDB ä¸­å°šå­˜åœ¨çš„é—®é¢˜\n\n- persistentVolumeClaim æ‹¿ä¸åˆ° PV çš„åŸå› æœªçŸ¥ï¼Œå¯èƒ½æ˜¯ pv æ²¡åˆ›å»ºå¯¹ï¼Ÿå¯èƒ½æ˜¯ pvc çš„è¦æ±‚ä¸æ»¡è¶³ï¼Ÿ\n- å°è¯•äº† hostPath ä½†å°šæœªå°è¯•å…¶ä»–ç±»å‹çš„ pv\n\n## å­˜å‚¨å·\n\n- Volume å’Œ PersistentVolume ç”¨äº pod å­˜å‚¨æ•°æ®\n- hostPath ä½œä¸º host ä¸Šçš„ä¸€ä¸ªç‰©ç†çš„æ–‡ä»¶å¤¹ä¸æ”¯æŒå¹¶å‘è¯»å†™\n\n## Affinity å’Œ AntiAffinity\n\n- Pod å’Œ Node éƒ½èƒ½å¤Ÿè®¾ç½®ç›¸äº’çš„äº²å’Œåº¦å’Œé€†äº²å’Œåº¦\n- é€šè¿‡ Label æˆ–è€…å…¶ä»–çš„ä¸€äº›å¯å“ˆå¸Œçš„å…·æœ‰å”¯ä¸€æ ‡å¿—çš„èµ„æºæ¥åˆ¤æ–­\n\n## Taint å’Œ Tolerance\n\n- å¯ä»¥è®¾ç½® Node å­˜åœ¨ä¸€äº›ã€Œæ±¡ç‚¹ã€ï¼Œå³ Taint ï¼Œåªæœ‰å¿å— Node çš„**å…¨éƒ¨**æ±¡ç‚¹çš„ Pod æ‰èƒ½å¤Ÿè¢«åˆ†é…åˆ°è¿™ä¸ªæœ‰æ±¡ç‚¹çš„ Node ä¸Šä¹ƒè‡³åœ¨ä¸Šé¢è¿è¡Œ\n- Node å¶å°”ä¼šæ ¹æ®æ±¡ç‚¹ã€Œé©±é€ã€ä¸€äº› Pod ï¼Œå³ä½¿ Pod å¿å—äº†è¿™äº›æ±¡ç‚¹ï¼Œè¿˜æ˜¯å¯èƒ½è¢«é©±é€ã€‚å› æ­¤è¿˜å¯ä»¥è®¾ç½® Pod è¢«é©±é€ååœ¨ Node ä¸Šå­˜æ´»çš„æ—¶é—´é•¿åº¦\n\n## å‡ ç§é‡è¦çš„èµ„æºçš„ç†è§£\n\n- ReplicaController æ˜¯æ¯”è¾ƒåŸºç¡€çš„èµ„æºï¼Œç”¨äºå®šä¹‰ä¸€äº› Pod\n- Deployment æ˜¯æ—©æœŸå®šä¹‰ä¸€ç»„æœåŠ¡çš„æ¯”è¾ƒå¸¸ç”¨çš„èµ„æºï¼Œåæ¥è¢« Statefule-Set æ‰€å–ä»£\n- Service ä¸åŒ…å« Pod å®šä¹‰ï¼Œä¸»è¦ç”¨åœ¨æœåŠ¡å‘ç°ä¸­ï¼Œå®šä¹‰é›†ç¾¤å‘å¤–æš´éœ²çš„æœåŠ¡\n- Ingress ä½¿ç”¨åå‘ä»£ç†å’ŒæœåŠ¡å‘ç°æœºåˆ¶ï¼Œå°†ç»™å®š Name çš„ Service é€šè¿‡ç‰¹å®šçš„ Port å’Œ HostName æš´éœ²å‡ºå»\n\nä»¥ä¸Šæ‰€æœ‰èµ„æºéƒ½å¯ä»¥é€šè¿‡ `kubectl create -f aaaa.yaml` æ¥åˆ›å»º\n\n## ä½¿ç”¨ Helm\n\nä½¿ç”¨ Helm ç®¡ç†éƒ¨ç½²éå¸¸ç®€å•ï¼Œä½†å¶å°”è¿˜éœ€è¦æ‰‹åŠ¨æ”¹ä¸€ä¸‹é¡¹ç›®çš„ Chart æ¨¡æ¿ã€‚\n"},{"title":"ä½¿ç”¨ Helm éƒ¨ç½²æœ‰çŠ¶æ€æœåŠ¡åˆ° Kubernetes ä¸Š","url":"/articles/2020/06/18/kubernetes/deploy-stateful-services/","content":"\n## åŸç”Ÿ k8s éƒ¨ç½²æœ‰çŠ¶æ€æœåŠ¡\n\n### Related k8s resources\n\n`ConfigMap`: å…¬å¼€çš„é”®å€¼å¯¹ï¼Œåœ¨è¿è¡Œæ—¶ä¼šå°†é…ç½®æ–‡ä»¶ã€å‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡ã€ç«¯å£å·ä»¥åŠå…¶ä»–é…ç½®è½¯ä»¶å·¥ä»¶ç»‘å®šåˆ° Pod çš„å®¹å™¨å’Œç³»ç»Ÿç»„ä»¶ã€‚å°†é…ç½®ä¸ Pod å’Œç»„ä»¶åˆ†å¼€ï¼Œè¿™æœ‰åŠ©äºä¿æŒå·¥ä½œè´Ÿè½½çš„å¯ç§»æ¤æ€§ï¼Œä½¿å…¶é…ç½®æ›´æ˜“äºæ›´æ”¹å’Œç®¡ç†ï¼Œå¹¶é˜²æ­¢å°†é…ç½®æ•°æ®ç¡¬ç¼–ç åˆ° Pod è§„èŒƒ\n\n`Secret`: ç§æœ‰çš„ã€åŠ å¯†çš„ï¼Œå­˜å‚¨æ•æ„Ÿé…ç½®ä¿¡æ¯\n\n`Service`:\n\n`PersistentVolumeClaim`: è¢«é›†ç¾¤åŠ¨æ€åˆ†é…çš„æŒä¹…åŒ–å­˜å‚¨\n\n`Deployment`:**ä¸å…·æœ‰å”¯ä¸€æ ‡è¯†**çš„ä¸€ç»„å¤šä¸ªç›¸åŒçš„ Podï¼Œè¿è¡Œåº”ç”¨çš„å¤šä¸ªå‰¯æœ¬ï¼Œè‡ªåŠ¨æ›¿æ¢å¤±è´¥æˆ–è€…æ— å“åº”çš„å®ä¾‹ä»¥ç¡®ä¿æ‰€éœ€çš„æ•°é‡çš„ Podã€‚æ¯”è¾ƒé€‚åˆ**æ— çŠ¶æ€åº”ç”¨**ï¼Œä½¿ç”¨ Pod æ¨¡æ¿ã€‚[GCP æ–‡æ¡£](https://cloud.google.com/kubernetes-engine/docs/concepts/deployment?hl=zh-cn)\n\n`Pod`: æœ€åŸºæœ¬çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨\n\n`StatefulSet`: ä¸ Deployment ç›¸å¯¹ï¼Œè¡¨ç¤ºå…·æœ‰å”¯ä¸€æ ‡è¯†çš„ä¸€ç»„ Podã€‚ç”¨äºéƒ¨ç½²[æœ‰çŠ¶æ€åº”ç”¨](https://cloud.google.com/kubernetes-engine/docs/how-to/deploying-workloads-overview?hl=zh-cn#stateful_applications)å’Œé›†ç¾¤åº”ç”¨ï¼Œä»¥å°†æ•°æ®ä¿å­˜åˆ°æ°¸ä¹…æ€§å­˜å‚¨ç©ºé—´ï¼Œé€‚åˆéƒ¨ç½² Kafkaã€MySQLã€Redisã€ZooKeeper ä»¥åŠå…¶ä»–éœ€è¦å”¯ä¸€æŒä¹…èº«ä»½å’Œç¨³å®šä¸»æœºåçš„åº”ç”¨ã€‚\n"},{"title":"Understanding Javascript Async","url":"/articles/2020/06/14/front-end/understanding-js-async/","content":"\n## Heap & Call Stack\n\nExecution contexts in call stack.\n\n![image-20191017184233049](/Users/mingshicai/Library/Application Support/typora-user-images/image-20191017184233049.png)\n\n## Single Thread & Callback\n\nDo one thing at a time. Callback added to a queue.\n\nCode to be call back later.\n\n## Callback Queue\n\nCallbacks in a queue, FIFO.\n\n## Microtask & Macrotask\n\nmicrotask in the background / task queue.\n\nmacrotask in the main thread.\n\n## Event Loop in Javascript\n\nWait until the **call stack** is clear, pop a **callback** and push it into **call stack**.\n\n## Microtask & Repaint\n\n![image-20191017191719769](/Users/mingshicai/Library/Application Support/typora-user-images/image-20191017191719769.png)\n\n![image-20191017192155393](/Users/mingshicai/Library/Application Support/typora-user-images/image-20191017192155393.png)\n\n## Webworkers\n\nIt has its own event loop.\n\n## Promise & Resolve\n\nA promise object, takes `resolve`, `reject` **callbacks**, with parameters as `value` or `reason`.\n\nWhen we call a promise, `promiseObject.then((value)=>{}).catch((reason)=>{})`.\n\nReturn a promise object in a function intead of **nested callbacks**.\n\n`Promise.all()` runs every single promise, and return all the `resolve` or `reject` parameters.\n\n```javascript\nPromise.all(p1, p2, p3)\n  .then((values) => {})\n  .catch((errors) => {});\n```\n\n`Promise.race()` it will return as the first promise resolved and return the single `resolve` value.\n\n## Async / Await\n\n[Reference on Youtube, The async await episode | promise](https://www.youtube.com/watch?v=vn3tm0quoqE)\n\nMake async code read like sync code.\n\nFollowing code automatically return a promise object.\n\n```javascript\nconst getEggs = async () => {\n  let eggs = [\"e\", \"g\", \"g\", \"s\"];\n  return eggs;\n};\n\nlet eggs = await getEggs();\n```\n\nOr make code simpler:\n\n```javascript\n// with async / await\nconst cookEggs = async () => {\n  let a = await getEggs();\n  let b = await getEggs();\n\n  return [a, b];\n};\n```\n\n`await` will pause the code, use `Promise.all` to accelerate your code when necessary:\n\n```javascript\nconst cookEggs = async () => {\n  let a = getEggs();\n  let b = getEggs();\n  result = Promise.all([a, b]);\n  return result;\n};\n```\n"},{"title":"Kubernetes æ€»ç»“ (1)","url":"/articles/2020/06/14/kubernetes/conclusion-in-k8s/","content":"\n## ç®€å•ç‰ˆæœ¬\n\n### éƒ¨ç½²ä¸€ä¸ª docker åº”ç”¨\n\n**ä¸‹é¢éƒ½æ²¡æŒ‡å®š namespaceï¼Œä½†å®é™…å¾ˆéœ€è¦ã€‚**\n\nåˆ›å»ºä¸€ä¸ª deployment èµ„æºã€‚\n\n`kubectl run hello-web --image=IMAGE_URL --port PORT`\n\næš´éœ² pod ç«¯å£ï¼Œåˆ›å»ºä¸€ä¸ª service èµ„æºã€‚\n\n`kubectl expose deployment hello-web --type=LoadBalancer --port 80 --target-port 8080`\n\næ‰©å±•åº”ç”¨ã€‚\n\n`kubectl scale deployment hello-web --replicas=3`\n\n### æ›´æ–°åº”ç”¨\n\nç›´æ¥è®¾ç½® deployment çš„é•œåƒå³å¯ã€‚\n\n`kubectl set image deployment/hello-web hello-web=IMAGE_URL`\n\n## ä½¿ç”¨ Ingress è´Ÿè½½å¹³è¡¡\n\n### åˆ›å»º ingress èµ„æº\n\nåœ¨ç®€å•ç‰ˆæœ¬ä¸­ï¼Œåˆ›å»ºå®Œäº† service èµ„æºåï¼Œå¯ä»¥æŸ¥çœ‹ service çš„é›†ç¾¤åœ°å€å’Œç«¯å£ã€‚\n\n`kubectl get service web`\n\nåˆ›å»º Ingress èµ„æºï¼Œå®ƒå°è£…äº†ä¸€ç³»åˆ—è§„åˆ™å’Œé…ç½®ï¼Œå¯å°†å¤–éƒ¨ HTTP(S) æµé‡è·¯ç”±åˆ°å†…éƒ¨æœåŠ¡ã€‚\n\nåˆ›å»ºç±»ä¼¼ä¸‹é¢çš„æ–‡ä»¶ï¼š\n\n```yaml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: basic-ingress\nspec:\n  backend:\n    serviceName: web\n    servicePort: 8080\n```\n\nç„¶åæ‰§è¡Œ `kubectl apply -f basic-ingress.yaml`ï¼Œè¿‡ä¸€ä¼šå„¿\n\næ‰§è¡Œ `kubectl get ingress basic-ingress`ï¼ŒæŸ¥çœ‹è´Ÿè½½å¹³è¡¡å™¨çš„å¤–éƒ¨ IP åœ°å€ï¼Œå¦‚ï¼š\n\n```shell\nNAME            HOSTS     ADDRESS         PORTS     AGE\nbasic-ingress   *         203.0.113.12    80        2m\n```\n\nå°±èƒ½é€šè¿‡å¤–éƒ¨åœ°å€è®¿é—®äº†ã€‚\n\n### é…ç½® é™æ€ ipã€ä¸åŒå­è·¯å¾„\n\nåœ¨åˆ›å»º ingress åï¼ŒæŒ‡å®šäº†ç«¯å£ï¼Œå¹¶è·å¾—äº† ipï¼Œä½†å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š\n\n1. å¤–éƒ¨ ip ä¸æ˜¯é™æ€çš„ï¼Œä¼šå‘ç”Ÿå˜åŒ–\n1. ç«¯å£ 8080 è‚¯å®šä¼šä¸å…¶ä»–åº”ç”¨å†²çªï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨åå‘ä»£ç†æŠŠéœ€è¦çš„ web æœåŠ¡ 8080 ç«¯å£æš´éœ²å‡ºå»ï¼Œå¹¶é€šè¿‡ hostName åŒºåˆ†ä¸åŒçš„æœåŠ¡\n\nå› æ­¤æˆ‘ä»¬éœ€è¦é™æ€ ipã€dns æœåŠ¡å’Œåå‘ä»£ç†æœåŠ¡ã€‚\n\næ›´æ–° ingress yaml æ–‡ä»¶ï¼š\n\n```yaml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: basic-ingress\n  annotations:\n    kubernetes.io/ingress.global-static-ip-name: \"web-static-ip\"\nspec:\n  backend:\n    serviceName: web\n    servicePort: 8080\n```\n\nä¹Ÿå¯ä»¥åœ¨ä¸€ä¸ª ingress æœåŠ¡ä¸­å¤„ç†å¤šä¸ªåº”ç”¨ï¼Œå‚è€ƒä¸Šé¢çš„æ­¥éª¤åˆ›å»ºå¦ä¸€ä¸ª web æœåŠ¡ï¼Œç„¶åæ›´æ–° ingress æ–‡ä»¶ï¼š\n\n```yaml\napiVersion: extensions/v1beta1\nkind: Ingress\nmetadata:\n  name: fanout-ingress\nspec:\n  rules:\n    - http:\n        paths:\n          - path: /*\n            backend:\n              serviceName: web\n              servicePort: 8080\n          - path: /v2/*\n            backend:\n              serviceName: web2\n              servicePort: 8080\n```\n\næ³¨æ„ï¼š**è¿™æ ·èƒ½å¤Ÿå®ç°åŒä¸€ä¸ªåŸŸåä½¿ç”¨ä¸åŒå­è·¯å¾„æä¾›ä¸åŒçš„ web æœåŠ¡ï¼Œæ¯”å¦‚ api æœåŠ¡å’Œ web æœåŠ¡**\n\n### åå‘ä»£ç†ä¸ k8s ä¸Šçš„ DNS æœåŠ¡\n"},{"title":"Focal Points in React.js","url":"/articles/2020/06/12/front-end/react-focal-points/","content":"\n## åŸºç¡€å›é¡¾\n\n### ç”Ÿå‘½å‘¨æœŸ\n\n- æŒ‚è½½\n  - componentDidMount\n  - componentWillMount\n  - constructor\n  - rendoer\n- æ›´æ–°\n  - render\n  - shouldComponentUpdate\n  - componentDidUpdate\n- å¸è½½\n  - componentWillUnmount\n\n### äº‹ä»¶å¤„ç†\n\nè¿™æ ·å®šä¹‰äº‹ä»¶å¤„ç†éœ€è¦è¿›è¡Œç»‘å®šï¼š\n\n```javascript\nclass A extends Component {\n  constructor(props) {\n    super(props);\n    this.handleBClick = this.handleBClick.bind(this);\n  }\n  handleBClick() {\n    //\n  }\n}\n```\n\nè¿™æ ·å°±ä¸éœ€è¦ï¼š\n\n```javascript\nclass A extends Component {\n  constructor(props) {\n    //\n    super(props);\n  }\n  handleBClick = () => {\n    //\n  };\n}\n```\n\n### Props\n\nReact ä¸­ï¼Œprops ä½œä¸ºå‡½æ•°çš„å‚æ•°ï¼Œå¯ä»¥ä½¿ç”¨ä»»ä½•ç±»å‹çš„å¯¹è±¡ï¼ŒåŒ…æ‹¬ Component, Function, js å¯¹è±¡ç­‰ã€‚\n\n### æ•°æ®åˆ†å‘ä¸æ•°æ®æå‡\n\nå•å‘æ•°æ®æµï¼Œçˆ¶ç»„ä»¶é€šè¿‡ props å‘å­ç»„ä»¶åˆ†å‘æ•°æ®ï¼Œå­ç»„ä»¶æ˜¯**çº¯å‡½æ•°**ã€‚\n\nè‹¥å­ç»„ä»¶éœ€è¦å‘çˆ¶ç»„ä»¶å‘é€æ•°æ®ï¼Œä½¿ç”¨çˆ¶ç»„ä»¶æä¾›çš„ **props ä¸­çš„å‡½æ•°**å‘çˆ¶ç»„ä»¶ä¼ é€’æ•°æ®ã€‚\n\nçˆ¶ç»„ä»¶å¯ä»¥é€šè¿‡ Context å‘å­ç»„ä»¶å¹¿æ’­æ•°æ®ï¼Œè€Œé¿å…é€šè¿‡ props å±‚å±‚ä¼ é€’ï¼Œä¸€ä¸ªç®€å•çš„ demoï¼š\n\n```javascript\n// åˆ›å»º Context\nconst ThemeContext = React.createContext(\"lightOption\");\n\nclass A extends Component {\n  render() {\n    return (\n      <ThemeContext.Provider value=\"dark\">\n        <Toolbar />\n      </ThemeContext.Provider>\n    );\n  }\n}\n\nfunction Toolbar(props) {\n  return (\n    <div>\n      <ThemedButton />\n    </div>\n  );\n}\n\nclass ThemedButton extends Component {\n  // éœ€è¦æŒ‡å®š contextType é™æ€\n  static contextType = ThemeContext;\n  render() {\n    // å‘ä¸Šæ‰¾æœ€è¿‘çš„ Provider å¹¶ä½¿ç”¨å…¶å€¼\n    return <button theme={this.props.context} />;\n  }\n}\n```\n\nprops ä¸­å¯ä»¥ä¼ é€’ Componentï¼Œå› æ­¤ä¹Ÿå¯ä»¥åœ¨é¡¶éƒ¨ç›´æ¥æŠŠæ•°æ®åŒ…è£…åˆ° Component ä¸­ç„¶åä¼ é€’ç»™å­ç»„ä»¶ï¼Œè¿™æ ·ä¼šè®²é€»è¾‘æå‡åˆ°ç»„ä»¶æ ‘çš„æ›´é«˜å±‚æ¬¡ã€ä½¿å¾—é«˜å±‚ç»„ä»¶æ›´å¤æ‚ã€‚\né™¤æ­¤ä¹‹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ render props æ¥å…±äº«æ•°æ®å’Œä»£ç é€»è¾‘ã€‚\n"},{"title":"MySQL ä¸»ä»å¤åˆ¶","url":"/articles/2020/05/30/database/mysql-master-slave/","content":"\n## æµç¨‹\n\næ›´æ–° master ä¸Šçš„ /etc/mysql/m.cnf æ–‡ä»¶\n\n```\n[mysqld]\nlog-bin=mysql-bin #å¼€å¯äºŒè¿›åˆ¶æ—¥å¿—\nserver-id=1 #è®¾ç½®server-id\n```\n\n```sql\ncreate user 'repl'@'%' identified with mysql_native_password by 'password';\n\ngrant replication slave on *.* to 'repl'@'%';\n\nflush privileges;\n\nchange master to master_host='192.168.0.82',master_port=32795, master_user='repl', master_password='password', master_log_file='mysql-bin.000001', master_log_pos=1413, master_connect_retry=30;\n\nchange master to master_host='172.17.0.3', master_user='repl', master_password='password', master_log_file='mysql-bin.000001', master_log_pos=825, master_connect_retry=30;\n\n-- message: Authentication plugin 'caching_sha2_password' reported error: Authentication requires secure connection\n-- change the encryption of password\nALTER USER 'yourusername'@'localhost' IDENTIFIED WITH mysql_native_password BY 'youpassword';\n```\n\nå¯ä»¥æŒ‡å®šåŒæ­¥çš„æ•°æ®åº“å’Œè¡¨ä»¥åŠæ—¥å¿—çš„ä¿å­˜æ—¶é—´ã€‚\n\n## è¦æ±‚\n\næ— è®ºä¸»ä»è¿˜æ˜¯åŒä¸»ï¼Œslave éœ€è¦é€šè¿‡å›ºå®š ip è®¿é—®åˆ° master æœåŠ¡å™¨ã€‚å› æ­¤ï¼Œéœ€è¦è®¾ç½®æœ¬åœ° master çš„ bin log çš„æŒç»­æ—¶é—´ï¼Œå¹¶åœ¨è¯¥æ—¶é—´å†…è®©è¿œç¨‹çš„ slave è¿æ¥åˆ°æœ¬åœ°çš„ master è¿›è¡ŒåŒæ­¥ã€‚\n\nè…¾è®¯äº‘çš„ saas çš„ mysql æœåŠ¡æ²¡æ³•é…ç½®ä¸»ä»å¤‡ä»½ã€‚\n\n## å‚è€ƒèµ„æ–™\n\n[åšå®¢å›­æ–‡ç« ](https://www.cnblogs.com/gl-developer/p/6170423.html)\n"},{"title":"æ··åˆäº‘ä¸­çš„ MySQL å¤‡ä»½å®æˆ˜","url":"/articles/2020/05/26/database/mysql-backup-in-action/","content":"\n## æ­¥éª¤\n\n### å¤‡ä»½\n\n1. åœ¨è·¯ç”±å™¨ä¸Šè¿æ¥åˆ° VPN\n2. åœ¨è…¾è®¯äº‘ VPN æœåŠ¡å™¨ä¸Šè®¾ç½®è·¯ç”±è¡¨ï¼Œä½¿å…¶å¯ä»¥è®¿é—®åˆ° LAN ä¸Šçš„ Mysql æœåŠ¡å™¨\n3. åœ¨è…¾è®¯äº‘ VPN æœåŠ¡å™¨ä¸Šè®¾ç½® Nginx åå‘ä»£ç† LAN çš„ Mysql æœåŠ¡å™¨\n4. ï¼ˆå¯é€‰ï¼‰åœ¨æœ¬åœ°åˆ›å»ºç”¨äºå¤‡ä»½çš„ mysql è´¦æˆ·ï¼Œéœ€è¦`replication`, `slave`æƒé™\n5. æœ¬åœ°æµ‹è¯•é€šè¿‡è…¾è®¯äº‘ VPN æœåŠ¡å™¨çš„å…¬ç½‘ ip + nginx è®¾ç½®çš„ç«¯å£å·è¿æ¥æœ¬åœ° mysql æœåŠ¡å™¨\n6. è‹¥è¿æ¥ä¸æˆåŠŸï¼Œè¯·æ£€æŸ¥ nginx é…ç½®å’Œ vpn è¿æ¥æ˜¯å¦æ­£å¸¸\n7. åœ¨é˜¿é‡Œäº‘ä¸Šè´­ä¹°`æ•°æ®åº“å¤‡ä»½DBS`\n8. è®¾ç½®å¤‡ä»½è®¡åˆ’ï¼Œè®¾ç½®å¤‡ä»½æºä¸ºè…¾è®¯äº‘ä¸Šçš„ VPN æœåŠ¡å™¨çš„å…¬ç½‘ ip + nginx ä¸Šè®¾ç½®çš„ç«¯å£å·\n9. å¯åŠ¨å¤‡ä»½è®¡åˆ’ï¼ŒåŒ…æ‹¬å…¨é‡å¤‡ä»½å’Œå¢é‡å¤‡ä»½\n\nç¬¬ 3 æ­¥ä¸­ Nginx é…ç½®æ–‡ä»¶ `/etc/nginx/nginx.conf`ï¼Œä¸€èˆ¬æ˜¯è¿™ä¸ªã€‚æ³¨æ„é€šè¿‡ `stream` è€Œä¸æ˜¯ `http`ï¼Œå…·ä½“æ–‡ä»¶å†…å®¹ï¼š\n\n```\nhttp {\n    ...\n}\n\nstream {\n    upstream mysql_lan_106 {\n        server 192.168.0.106:3306;\n    }\n\n    server {\n        listen 33060;\n        proxy_pass mysql_lan_106;\n    }\n}\n\n```\n\næ›´æ–°åï¼Œè¿è¡Œ `sudo nginx -s reload` æ¥é‡å¯ nginxã€‚\n\n### æ¢å¤\n\nåœ¨é˜¿é‡Œäº‘ dbs ä¸­é€‰æ‹©`æ¢å¤ä»»åŠ¡`ï¼Œè®¾ç½®æ¢å¤å…¨é‡+å¢é‡çš„å¤‡ä»½ï¼Œè®¾ç½®ç›®çš„æ•°æ®åº“ä¸ºå·²ç»å¯ä»¥é€šè¿‡è…¾è®¯äº‘ä¸»æœºä¸Šæ­å»ºçš„ VPN è®¿é—®çš„æœ¬åœ° Mysql æœåŠ¡å™¨ï¼Œé…ç½®å·²ç»æœ‰åˆé€‚æƒé™çš„è´¦å·ã€‚åœ¨å¯åŠ¨æ¢å¤ä»»åŠ¡å‰ä¼šæ£€æŸ¥ï¼Œå¦‚æœå‡ºé”™ï¼ŒæŒ‰ç…§æç¤ºé…ç½®å³å¯ã€‚\n\n### æ³¨æ„\n\n1. é˜¿é‡Œäº‘çš„å¤‡ä»½è®¡åˆ’åªèƒ½åŒæ—¶å¤‡ä»½ä¸€ä¸ªæºæ•°æ®åº“ï¼›\n2. ä¿æŒ VPN è¿æ¥ã€‚é˜¿é‡Œäº‘ä¼šåœ¨ä¸€å®šæ—¶é—´å†…å°è¯•é‡æ–°è¿æ¥æº/ç›®çš„æ•°æ®åº“ï¼Œè¶…æ—¶åä»»åŠ¡å¤±è´¥ï¼Œæ— æ³•æ–­ç‚¹ç»­ä¼ ï¼›\n3. å¯ä»¥é€šè¿‡æœ‰å…¬ç½‘ ip çš„ VPN æœåŠ¡å™¨åå‘ä»£ç†æœ¬åœ°çš„ä»»æ„ Mysql æœåŠ¡ã€‚\n\n## å®é™…å¤‡ä»½æµ‹è¯•\n\nè´­ä¹°çš„æ˜¯ä¸€ä¸ªæœˆçš„ small ç‰ˆçš„é€»è¾‘å¤‡ä»½è®¡åˆ’ï¼ŒèŠ±è´¹ 140 å…ƒï¼ŒåŒ…å« 400GB/æœˆ çš„æµé‡ï¼Œè¶…å‡ºçš„æµé‡ 0.35 å…ƒ/GBï¼Œå•ç‹¬è´­ä¹°å­˜å‚¨åŒ…æ— æ³•è¿›è¡Œå¤‡ä»½ï¼Œä½†å¯ä»¥æŠµæ‰£è¶…å‡ºçš„æµé‡ï¼ˆè²Œä¼¼ï¼‰ã€‚\n\nå¤‡ä»½ï¼šæµ‹è¯•å¤‡ä»½å’Œæ¢å¤ 106 æ•°æ®åº“ä¸Šçš„ finance åº“ï¼Œä¼ è¾“é€Ÿåº¦çº¦ä¸º 1MB/s å·¦å³ï¼Œå¤‡ä»½è€—æ—¶å¤§çº¦ 1 å°æ—¶ï¼Œå¤‡ä»½å¤§å° 23.63GBã€‚\næ¢å¤ï¼š\n\n## ä¸å¯è¡Œçš„æ–¹æ¡ˆ\n\n### ä½¿ç”¨è…¾è®¯äº‘ mysql å®ä¾‹è¿›è¡Œä¸»ä»æˆ–åŒä¸»å¤‡ä»½\n\n- è…¾è®¯äº‘ mysql å®ä¾‹çš„è´¦å·æ²¡æœ‰æƒé™ç”¨æ¥é…ç½® master/slave\n\n## å‚è€ƒèµ„æ–™\n"},{"title":"MySQL é”ç›¸å…³çŸ¥è¯†æ€»ç»“","url":"/articles/2020/05/22/database/locks-in-mysql/","content":"\n## äº‹åŠ¡\n\næ•°æ®åº“äº‹åŠ¡: **äº‹åŠ¡(Transaction)**ï¼Œä¸€èˆ¬æ˜¯æŒ‡è¦åšçš„æˆ–æ‰€åšçš„äº‹æƒ…ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­æ˜¯æŒ‡è®¿é—®å¹¶å¯èƒ½æ›´æ–°æ•°æ®åº“ä¸­å„ç§æ•°æ®é¡¹çš„ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒ(unit)ã€‚åœ¨è®¡ç®—æœºæœ¯è¯­ä¸­ï¼Œäº‹åŠ¡é€šå¸¸å°±æ˜¯æŒ‡æ•°æ®åº“äº‹åŠ¡ã€‚\n\nä¸€ä¸ªæ•°æ®åº“äº‹åŠ¡é€šå¸¸åŒ…å«å¯¹æ•°æ®åº“è¿›è¡Œè¯»æˆ–å†™çš„ä¸€ä¸ªæ“ä½œåºåˆ—ã€‚å®ƒçš„å­˜åœ¨åŒ…å«æœ‰ä»¥ä¸‹ä¸¤ä¸ªç›®çš„ï¼š\n\n> 1ã€ä¸ºæ•°æ®åº“æ“ä½œæä¾›äº†ä¸€ä¸ªä»å¤±è´¥ä¸­æ¢å¤åˆ°æ­£å¸¸çŠ¶æ€çš„æ–¹æ³•ï¼ŒåŒæ—¶æä¾›äº†æ•°æ®åº“å³ä½¿åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹ä»èƒ½ä¿æŒä¸€è‡´æ€§çš„æ–¹æ³•ã€‚\n> 2ã€å½“å¤šä¸ªåº”ç”¨ç¨‹åºåœ¨å¹¶å‘è®¿é—®æ•°æ®åº“æ—¶ï¼Œå¯ä»¥åœ¨è¿™äº›åº”ç”¨ç¨‹åºä¹‹é—´æä¾›ä¸€ä¸ªéš”ç¦»æ–¹æ³•ï¼Œä»¥é˜²æ­¢å½¼æ­¤çš„æ“ä½œäº’ç›¸å¹²æ‰°ã€‚\n\nå³:1.å½“ä¸€ä¸ªäº‹åŠ¡è¢«æäº¤ç»™äº† DBMSï¼ˆæ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼‰ï¼Œåˆ™ DBMS éœ€è¦ç¡®ä¿è¯¥äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½æˆåŠŸå®Œæˆä¸”å…¶ç»“æœè¢«æ°¸ä¹…ä¿å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œå¦‚æœäº‹åŠ¡ä¸­æœ‰çš„æ“ä½œæ²¡æœ‰æˆåŠŸå®Œæˆï¼Œåˆ™äº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½éœ€è¦è¢«å›æ»šï¼Œå›åˆ°äº‹åŠ¡æ‰§è¡Œå‰çš„çŠ¶æ€ï¼ˆè¦ä¹ˆå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå…¨éƒ½ä¸æ‰§è¡Œï¼‰; 2.åŒæ—¶ï¼Œè¯¥äº‹åŠ¡å¯¹æ•°æ®åº“æˆ–è€…å…¶ä»–äº‹åŠ¡çš„æ‰§è¡Œæ— å½±å“ï¼Œæ‰€æœ‰çš„äº‹åŠ¡éƒ½å¥½åƒåœ¨ç‹¬ç«‹çš„è¿è¡Œã€‚\n\n**äº‹åŠ¡çš„ 4 ä¸ªå±æ€§ acid**: atom åŸå­æ€§,ä½œä¸ºä¸€ä¸ªæ•´ä½“è¢«æ‰§è¡Œ,consistency ä¸€è‡´æ€§,æ•°æ®æ»¡è¶³å®Œæ•´æ€§çº¦æŸ,isolation éš”ç¦»æ€§,ä¸å½±å“å…¶ä»–äº‹ç‰©,durability æŒä¹…æ€§,äº‹åŠ¡æ‰§è¡ŒæˆåŠŸåå¯¹æ•°æ®åº“çš„ä¿®æ”¹è¢«æ°¸ä¹…è®°å½•.\n\n## äº‹åŠ¡éš”ç¦»çº§åˆ«\n\nMysql å¯ä»¥è®¾ç½® 4 ä¸ªéš”ç¦»çº§åˆ«,å…è®¸ç”¨æˆ·åœ¨æ€§èƒ½å’Œå¯é æ€§ä¹‹é—´ä½œå‡ºé€‰æ‹©.\n\nRead uncommitted, **ä¼šå‡ºç°è¯»åˆ°äº†æœªæäº¤çš„æ•°æ®(è„è¯»);** äº‹åŠ¡ b è¯»åˆ°äº†äº‹åŠ¡ a å°šæœªæäº¤çš„æ•°æ®,è¯¥æ•°æ®å¯èƒ½ä¼šè¢«äº‹åŠ¡ a å›æ»š.å³**è„è¯»**.\n\nread committed, **ä¼šå‡ºç°è¯»åˆ°çš„æ•°æ®è¢«åˆ«çš„äº‹åŠ¡æäº¤æ›´æ–°äº†,ä¹Ÿå°±æ˜¯åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­,ä¸¤æ¬¡è¯»åˆ°çš„æ•°æ®ä¸æ˜¯ä¸€è‡´çš„**(**ä¸å¯é‡å¤è¯»**); äº‹åŠ¡ a å…ˆè¯»å–äº†æ•°æ®,äº‹åŠ¡ b ä¹Ÿè¯»åŒºäº†,ä½† b æ›´æ–°äº†æ•°æ®å¹¶æäº¤äº†äº‹åŠ¡,è€Œ a å†æ¬¡è¯»æ•°æ®æ—¶,æ•°æ®å·²ç»å˜äº†.å³**ä¸å¯é‡å¤è¯»**.\n\nrepeatable read, mysql çš„é»˜è®¤éš”ç¦»çº§åˆ«;å°½ç®¡é€šè¿‡ **Next-Key Lock** æŸç§ç¨‹åº¦ä¸Šè§£å†³äº†å¹»è¯»è¯»é—®é¢˜,ä½†ä»å¯èƒ½å‡ºç°å¹»è¯»(äº‹åŠ¡åœ¨æ’å…¥äº‹å…ˆæ£€æµ‹ä¸å­˜åœ¨çš„è®°å½•æ—¶ï¼ŒæƒŠå¥‡çš„å‘ç°è¿™äº›æ•°æ®å·²ç»å­˜åœ¨äº†ï¼Œä¹‹å‰çš„æ£€æµ‹è¯»è·å–åˆ°çš„æ•°æ®å¦‚åŒé¬¼å½±ä¸€èˆ¬ã€‚**\\*åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼ŒåŒä¸€ä¸ªèŒƒå›´å†…çš„è®°å½•è¢«è¯»å–æ—¶ï¼Œå…¶ä»–äº‹åŠ¡å‘è¿™ä¸ªèŒƒå›´æ·»åŠ äº†æ–°çš„è®°å½•**ã€‚\\*).\n\n**å¹»è¯»ä¾‹å­**: é‡æ–°å¼€å¯äº†ä¸¤ä¸ªä¼šè¯ `SESSION 1` å’Œ `SESSION 2`ï¼Œåœ¨ `SESSION 1` ä¸­æˆ‘ä»¬æŸ¥è¯¢å…¨è¡¨çš„ä¿¡æ¯ï¼Œæ²¡æœ‰å¾—åˆ°ä»»ä½•è®°å½•ï¼›åœ¨ `SESSION 2` ä¸­å‘è¡¨ä¸­æ’å…¥ä¸€æ¡æ•°æ®å¹¶æäº¤ï¼›ç”±äº `REPEATABLE READ` çš„åŸå› ï¼Œå†æ¬¡æŸ¥è¯¢å…¨è¡¨çš„æ•°æ®æ—¶ï¼Œæˆ‘ä»¬è·å¾—åˆ°çš„ä»ç„¶æ˜¯ç©ºé›†ï¼Œä½†æ˜¯åœ¨å‘è¡¨ä¸­æ’å…¥åŒæ ·çš„æ•°æ®å´å‡ºç°äº†é”™è¯¯ã€‚\n\nè¿™ç§ç°è±¡åœ¨æ•°æ®åº“ä¸­å°±è¢«ç§°ä½œå¹»è¯»ï¼Œ**è™½ç„¶æˆ‘ä»¬ä½¿ç”¨æŸ¥è¯¢è¯­å¥å¾—åˆ°äº†ä¸€ä¸ªç©ºçš„é›†åˆï¼Œä½†æ˜¯æ’å…¥æ•°æ®æ—¶å´å¾—åˆ°äº†é”™è¯¯ï¼Œå¥½åƒä¹‹å‰çš„æŸ¥è¯¢æ˜¯å¹»è§‰ä¸€æ ·**ã€‚\n\nserializable.**ä¸²è¡Œ**;æœ€é«˜çº§åˆ«,ä½†æ˜¯ä»£ä»·é«˜,æ€§èƒ½ä½,ä¸€èˆ¬å¾ˆå°‘ä½¿ç”¨,**äº‹åŠ¡ä¸²è¡Œæ‰§è¡Œ**.é€šå¸¸,åœ¨å®é™…åº”ç”¨ä¸­è‡ªå·±åŠ é”æ¥é¿å…å¹»è¯».\n\n|     | è„è¯»     | ä¸å¯é‡å¤è¯» | å¹»è¯»     |\n| --- | -------- | ---------- | -------- |\n| Ru  | å¯èƒ½å‡ºç° | å¯èƒ½å‡ºç°   | å¯èƒ½å‡ºç° |\n| Rc  |          | å¯èƒ½å‡ºç°   | å¯èƒ½å‡ºç° |\n| Rr  |          |            | å¯èƒ½å‡ºç° |\n| S   |          |            |          |\n\n## å¹¶å‘æ§åˆ¶\n\n**æ‚²è§‚é”**ï¼šå‡å®šä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œ\\*\\*å±è”½ä¸€åˆ‡å¯èƒ½è¿åæ•°æ®å®Œæ•´æ€§çš„æ“ä½œã€‚InnoDB ä½¿ç”¨çš„æ˜¯æ‚²è§‚é”.\n\n**ä¹è§‚é”**ï¼šå‡è®¾ä¸ä¼šå‘ç”Ÿå¹¶å‘å†²çªï¼Œ**åªåœ¨æäº¤æ“ä½œæ—¶æ£€æŸ¥æ˜¯å¦è¿åæ•°æ®å®Œæ•´æ€§**ã€‚ä¸æ˜¯ä¸€ç§çœŸæ­£çš„é”,å†²çªäº†å°±é‡è¯•,æ²¡æœ‰å¯¹æ•°æ®åº“åŠ é”.**ä¹è§‚é”å› ä¸ºæ²¡æœ‰çœŸæ­£åŠ é”,æ‰€ä»¥ä¸èƒ½è§£å†³è„è¯»çš„é—®é¢˜**ã€‚å®ƒä¼šå…ˆå°è¯•å¯¹èµ„æºè¿›è¡Œä¿®æ”¹ï¼Œåœ¨å†™å›æ—¶åˆ¤æ–­èµ„æºæ˜¯å¦è¿›è¡Œäº†æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰å‘ç”Ÿæ”¹å˜å°±ä¼šå†™å›ï¼Œå¦åˆ™å°±ä¼šè¿›è¡Œé‡è¯•ï¼Œ\n\nä¹è§‚é”ä¸ä¼šå­˜åœ¨æ­»é”çš„é—®é¢˜ï¼Œä½†æ˜¯ç”±äºæ›´æ–°åéªŒè¯ï¼Œæ‰€ä»¥å½“**å†²çªé¢‘ç‡**å’Œ**é‡è¯•æˆæœ¬**è¾ƒé«˜æ—¶æ›´æ¨èä½¿ç”¨æ‚²è§‚é”ï¼Œè€Œéœ€è¦éå¸¸é«˜çš„**å“åº”é€Ÿåº¦**å¹¶ä¸”**å¹¶å‘é‡**éå¸¸å¤§çš„æ—¶å€™ä½¿ç”¨ä¹è§‚é”å°±èƒ½è¾ƒå¥½çš„è§£å†³é—®é¢˜ï¼Œåœ¨è¿™æ—¶ä½¿ç”¨æ‚²è§‚é”å°±å¯èƒ½å‡ºç°ä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼›åœ¨é€‰æ‹©å¹¶å‘æ§åˆ¶æœºåˆ¶æ—¶ï¼Œéœ€è¦ç»¼åˆè€ƒè™‘ä¸Šé¢çš„å››ä¸ªæ–¹é¢ï¼ˆå†²çªé¢‘ç‡ã€é‡è¯•æˆæœ¬ã€å“åº”é€Ÿåº¦å’Œå¹¶å‘é‡ï¼‰è¿›è¡Œé€‰æ‹©ã€‚\n\n## é”çš„åˆ†ç±»\n\n**å…±äº«é”**ä»£è¡¨äº†è¯»æ“ä½œã€äº’æ–¥é”ä»£è¡¨äº†å†™æ“ä½œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨æ•°æ®åº“ä¸­**å¹¶è¡Œè¯»**ï¼Œä½†æ˜¯åªèƒ½**ä¸²è¡Œå†™**ï¼Œåªæœ‰è¿™æ ·æ‰èƒ½ä¿è¯ä¸ä¼šå‘ç”Ÿçº¿ç¨‹ç«äº‰ï¼Œå®ç°çº¿ç¨‹å®‰å…¨ã€‚\n\né”çš„ç²’åº¦,åŒ…æ‹¬**è¡Œé”ã€è¡¨é”**,è¿˜å¼•å…¥äº†**æ„å‘é”**,æ˜¯ä¸€ç§è¡¨çº§é”.\n\n**æ„å‘é”**å…¶å®ä¸ä¼šé˜»å¡å…¨è¡¨æ‰«æä¹‹å¤–çš„ä»»ä½•è¯·æ±‚ï¼Œå®ƒä»¬çš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†è¡¨ç¤º**æ˜¯å¦æœ‰äººè¯·æ±‚é”å®šè¡¨ä¸­çš„æŸä¸€è¡Œæ•°æ®**ã€‚\n\nç†è§£æ„å‘é”çš„ç›®çš„: æˆ‘ä»¬åœ¨è¿™é‡Œå¯ä»¥ä¸¾ä¸€ä¸ªä¾‹å­ï¼šå¦‚æœæ²¡æœ‰æ„å‘é”ï¼Œå½“å·²ç»æœ‰äººä½¿ç”¨è¡Œé”å¯¹è¡¨ä¸­çš„æŸä¸€è¡Œè¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¦‚æœå¦å¤–ä¸€ä¸ªè¯·æ±‚è¦å¯¹å…¨è¡¨è¿›è¡Œä¿®æ”¹ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹æ‰€æœ‰çš„è¡Œæ˜¯å¦è¢«é”å®šè¿›è¡Œæ‰«æï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ•ˆç‡æ˜¯éå¸¸ä½çš„ï¼›ä¸è¿‡ï¼Œåœ¨å¼•å…¥æ„å‘é”ä¹‹åï¼Œå½“æœ‰äººä½¿ç”¨è¡Œé”å¯¹è¡¨ä¸­çš„æŸä¸€è¡Œè¿›è¡Œä¿®æ”¹ä¹‹å‰ï¼Œä¼šå…ˆä¸ºè¡¨æ·»åŠ æ„å‘äº’æ–¥é”ï¼ˆIXï¼‰ï¼Œå†ä¸ºè¡Œè®°å½•æ·»åŠ äº’æ–¥é”ï¼ˆXï¼‰ï¼Œ**åœ¨è¿™æ—¶å¦‚æœæœ‰äººå°è¯•å¯¹å…¨è¡¨è¿›è¡Œä¿®æ”¹å°±ä¸éœ€è¦åˆ¤æ–­è¡¨ä¸­çš„æ¯ä¸€è¡Œæ•°æ®æ˜¯å¦è¢«åŠ é”äº†ï¼Œåªéœ€è¦é€šè¿‡ç­‰å¾…æ„å‘äº’æ–¥é”è¢«é‡Šæ”¾å°±å¯ä»¥äº†ã€‚**\n\n## é”çš„ç®—æ³•\n\n**è®°å½•é” record lock** æ·»åŠ åˆ°**ç´¢å¼•è®°å½•**ä¸Šçš„é”.åœ¨å»ºè¡¨æ—¶å¦‚æœæŒ‡å®šäº† `key` é‚£ä¹ˆ,InnoDB å°±èƒ½é€šè¿‡ B+æ ‘æ‰¾åˆ°è¡Œè®°å½•å¹¶æ·»åŠ ç´¢å¼•.å¦åˆ™,ä¸çŸ¥é“å¾…ä¿®æ”¹çš„è®°å½•å…·ä½“çš„ä½ç½®,åªèƒ½é”å®šæ•´ä¸ªè¡¨.\n\n**é—´éš™é” gap lock** æ˜¯å¯¹ç´¢å¼•è®°å½•ä¸­çš„ä¸€æ®µè¿ç»­åŒºåŸŸçš„é”ï¼›å½“ä½¿ç”¨ç±»ä¼¼ `SELECT * FROM users WHERE id BETWEEN 10 AND 20 FOR UPDATE;` çš„ SQL è¯­å¥æ—¶ï¼Œå°±ä¼šé˜»æ­¢å…¶ä»–äº‹åŠ¡å‘è¡¨ä¸­æ’å…¥ `id = 15` çš„è®°å½•ï¼Œå› ä¸º**æ•´ä¸ªèŒƒå›´éƒ½è¢«é—´éš™é”é”å®š**äº†ã€‚\n\n> _é—´éš™é”æ˜¯å­˜å‚¨å¼•æ“å¯¹äºæ€§èƒ½å’Œå¹¶å‘åšå‡ºçš„æƒè¡¡ï¼Œå¹¶ä¸”åªç”¨äºæŸäº›äº‹åŠ¡éš”ç¦»çº§åˆ«ã€‚_\n\nè™½ç„¶é—´éš™é”ä¸­ä¹Ÿåˆ†ä¸ºå…±äº«é”å’Œäº’æ–¥é”ï¼Œä¸è¿‡å®ƒä»¬ä¹‹é—´å¹¶ä¸æ˜¯äº’æ–¥çš„ï¼Œä¹Ÿå°±æ˜¯ä¸åŒçš„äº‹åŠ¡å¯ä»¥åŒæ—¶æŒæœ‰ä¸€æ®µç›¸åŒèŒƒå›´çš„å…±äº«é”å’Œäº’æ–¥é”ï¼Œå®ƒå”¯ä¸€é˜»æ­¢çš„å°±æ˜¯**å…¶ä»–äº‹åŠ¡å‘è¿™ä¸ªèŒƒå›´ä¸­æ·»åŠ æ–°çš„è®°å½•**ã€‚\n\n**è®°å½•é”å’Œé—´éš™é”çš„ç»“åˆ:Next-Key Lock** æ—¢ç„¶å« Next-Key é”ï¼Œé”å®šçš„åº”è¯¥æ˜¯å½“å‰å€¼å’Œåé¢çš„èŒƒå›´ï¼Œä½†æ˜¯å®é™…ä¸Šå´ä¸æ˜¯ï¼ŒNext-Key é”é”å®šçš„æ˜¯å½“å‰å€¼å’Œå‰é¢çš„èŒƒå›´.å½“æˆ‘ä»¬æ›´æ–°ä¸€æ¡è®°å½•ï¼Œæ¯”å¦‚ `SELECT * FROM users WHERE age = 30 FOR UPDATE;`ï¼ŒInnoDB ä¸ä»…ä¼šåœ¨èŒƒå›´ `(21, 30]` ä¸ŠåŠ  Next-Key é”ï¼Œè¿˜ä¼šåœ¨è¿™æ¡è®°å½•åé¢çš„èŒƒå›´ `(30, 40]` åŠ é—´éš™é”ï¼Œæ‰€ä»¥æ’å…¥ `(21, 40]` èŒƒå›´å†…çš„è®°å½•éƒ½ä¼šè¢«é”å®šã€‚\n\nNext-Key é”çš„ä½œç”¨å…¶å®æ˜¯ä¸ºäº†è§£å†³**å¹»è¯»**çš„é—®é¢˜.\n\n**ä¸ä½¿ç”¨ç´¢å¼•æ¥æ›´æ–°,ä¼šå¯¼è‡´è¡¨é”çš„æƒ…å†µ.**\n\nå‚è€ƒèµ„æ–™:[ã€æµ…å…¥æµ…å‡ºã€MySQL å’Œ InnoDB](https://draveness.me/mysql-innodb#)\n"},{"title":"How to Debug Those Projects","url":"/articles/2020/04/25/guide/how-to-debug/","content":"\nThis article aims to clarify how-to in debugging for following popular projects:\n\n- Kubernetes related\n  - Helm\n  - Ingress\n  - Service/Deployment/Pod\n\n\n\n:TODO\n\n\n\n\n\n"},{"title":"Golang Concurrency Pattern","url":"/articles/2020/04/14/golang/go-concurrency/","content":"\næ³¨æ„ï¼šä»¥ä¸‹æ‰€è¯´çš„çº¿ç¨‹ã€è¿›ç¨‹ã€åç¨‹éƒ½æ˜¯æŒ‡ä¸€ä¸ªä¸œè¥¿ï¼š`goroutine`\n\n## 5 ç§æ¨¡å¼\n\n- æœ€å¤§è¾“å…¥çš„ç®¡é“\n- ä»»åŠ¡åˆ†è§£å¤šä¸ªåç¨‹ï¼Œç»“æœå½¼æ­¤æ— å…³\n- çº¿ç¨‹å®‰å…¨çš„æ•°æ®ç»“æ„ï¼Œä¸éœ€è¦é”\n- ä¸‰ç§æ–¹æ³•ï¼Œå°†ä»»åŠ¡åˆ†æˆå›ºå®šå¤šä¸ªåç¨‹ï¼Œå¹¶åœ¨æœ€ååˆå¹¶ç»“æœ\n- åˆ›å»ºè¿›ç¨‹ä¾èµ–çš„æ•°é‡çš„åç¨‹ï¼Œå¹¶åœ¨æœ€ååˆå¹¶ç»“æœ\n\n## æ­»é”\n\n- å› ä¸ºæ²¡æœ‰å®Œæˆä¿¡å·ï¼Œæ‰€æœ‰åç¨‹éƒ½æ²¡æœ‰é€€å‡ºï¼Œå³ä½¿ä»»åŠ¡å·²ç»å®Œæˆ\n- é˜»å¡çš„çº¿ç¨‹æƒ³è¦è·å¾—å…¶å®ƒæ­£åœ¨é˜»å¡çš„çº¿ç¨‹çš„é”\n\nä½¿ç”¨ done é€šé“æŠ¥å‘Šç»“æœã€‚\n\nä½¿ç”¨ sync.WaitGroup ï¼Œä½†å½“å…¶å®ƒçº¿ç¨‹æ­£åœ¨é˜»å¡ï¼Œè€Œ sync.WaitGroup.Wait() åœ¨ä¸»è¿›ç¨‹è¢«è°ƒç”¨æ—¶ï¼Œå°±ä¼šå‡ºç°æ­»é”ã€‚\n\nä½¿ç”¨ Channel ä¾ç„¶ä¼šå¯¼è‡´æ­»é”ï¼Œæ¯”å¦‚\n\n## çº¿ç¨‹å®‰å…¨æ€§\n\nå®‰å…¨ï¼šbool, int, float64, string\n\nä¸å®‰å…¨ï¼š\n\n- å¼•ç”¨ç±»å‹ï¼Œé™¤é 1.äº’æ–¥é‡ 2.è®¿é—®è§„åˆ™ 3.ä¸ä¿®æ”¹\n- å®šä¹‰äº†ä¿®æ”¹çš„æ¥å£ç±»å‹\n\næ²¡æœ‰ç¼“å†²åŒºçš„é€šé“ä¼šç«‹å³é˜»å¡ï¼Œç›´åˆ°æœ‰å…¶å®ƒè¿›ç¨‹ä»ä¸­è¯»å–ã€‚ç¼“å†²åŒºèƒ½å¤Ÿæé«˜ååé‡ã€‚\n\nå‘é€ç«¯çš„è¿›ç¨‹å…³é—­é€šé“\n\nå•å‘é€šé“è¡¨è¾¾ç¨‹åºæ€æƒ³\n\né€šé“å…³é—­\n\nåˆç†è®¾ç½®ç¼“å†²åŒºå¤§å°å’Œè¿›ç¨‹æ•°é‡ï¼Œå°½å¯èƒ½å°†ä¸å¿…è¦çš„é˜»å¡é™ä½åˆ°æœ€ä½\n\nå¸¦æœ‰é€šé“å‚æ•°çš„å‡½æ•°ï¼Œé€šå¸¸å°†ç›®æ ‡é€šé“æ”¾åœ¨å‰é¢ï¼Œæºé€šé“æ”¾åœ¨åé¢ã€‚\n\nåŒå‘é€šé“æ‰å…è®¸å…³é—­\n\nä½¿ç”¨éé˜»å¡ selectï¼Œå¯é€šè¿‡ timeout é€€å‡º\n\nçº¿ç¨‹å®‰å…¨çš„æ˜ å°„ï¼Œèƒ½å¤Ÿè¢«å¤šä¸ªçº¿ç¨‹å…±äº«ã€‚åªè¦æŒ‰ç…§ safemap/safemap.go å®šä¹‰çš„ SafeMap æ¥å£å®ç°å°±è¡Œã€‚\n\n> å¯å¯¼å‡º/ä¸å¯å¯¼å‡ºçš„æ¥å£\n\n## åŒæ­¥\n\n- å¯¹äºä»æ— ç¼“å†² Channel è¿›è¡Œçš„æ¥æ”¶ï¼Œå‘ç”Ÿåœ¨å¯¹è¯¥ Channel è¿›è¡Œçš„å‘é€å®Œæˆä¹‹å‰\n- å¯¹äºå¸¦ç¼“å†²çš„ Channelï¼Œå¯¹äº Channel çš„ç¬¬ K ä¸ªæ¥æ”¶å®Œæˆæ“ä½œå‘ç”Ÿåœ¨ç¬¬ K+C ä¸ªå‘é€æ“ä½œå®Œæˆä¹‹å‰ï¼Œå…¶ä¸­ C æ˜¯ Channel çš„ç¼“å­˜å¤§å°\n"},{"title":"Packages in Java","url":"/articles/2020/03/27/java/packages-in-java/","content":"\n## User Defined Packages\n\nFirst we create a directory myPackage (name should be same as the name of the package). Then create the MyClass inside the directory with the first statement being the package names.\n\n## Directory Structure\n\n`BASE_DIR` and `CLASSPATH`\n\nThe base directory ($BASE_DIR) could be located anywhere in the file system. Hence, the Java compiler and runtime must be informed about the location of the $BASE_DIR so as to locate the classes. This is accomplished by an environment variable called CLASSPATH. CLASSPATH is similar to another environment variable PATH, which is used by the command shell to search for the executable programs.\n\nå¯ä»¥å°† jar åŒ…ç›´æ¥åŠ åˆ° `CLASSPATH` ä¸­ï¼Œç„¶åå°±å¯ä»¥æ­£å¸¸å¼•ç”¨è¿™ä¸ªåŒ…äº†ã€‚\n\n## Ref\n\n[geeksforgeeks](https://www.geeksforgeeks.org/packages-in-java/)\n"},{"title":"Null Things in Java","url":"/articles/2020/03/22/java/null-thins-in-java/","content":"\n## Boxing and Unboxing null object\n\n```java\npublic class Test\n{\n\tpublic static void main (String[] args) throws java.lang.Exception\n\t{\n\t\t\t//An integer can be null, so this is fine\n\t\t\tInteger i = null;\n\n\t\t\t//Unboxing null to integer throws NullpointerException\n\t\t\tint a = i;\n\t}\n}\n```\n\n## Instanceof\n\n```java\npublic class Test\n{\n\tpublic static void main (String[] args) throws java.lang.Exception\n\t{\n\t\tInteger i = null;\n\t\tInteger j = 10;\n\n\t\t//prints false\n\t\tSystem.out.println(i instanceof Integer);\n\n\t\t//Compiles successfully\n\t\tSystem.out.println(j instanceof Integer);\n\t}\n}\n```\n\n## Static and Non-Static\n\n```java\npublic class Test\n{\n\tpublic static void main(String args[])\n\t{\n\t\tTest obj= null;\n\t\tobj.staticMethod();\n\t\tobj.nonStaticMethod();\n\t}\n\n\tprivate static void staticMethod()\n\t{\n\t\t//Can be called by null reference\n\t\tSystem.out.println(\"static method, can be called by null reference\");\n\t}\n\n\tprivate void nonStaticMethod()\n\t{\n\t\t//Can not be called by null reference\n\t\tSystem.out.print(\" Non-static method- \");\n\t\tSystem.out.println(\"cannot be called by null reference\");\n\t}\n}\n```\n\n## Comparison\n\n`null == null`, `null != null`\n\n`true, false`\n"},{"title":"Currying Functions with `java.util.function.Function`","url":"/articles/2020/03/16/java/currying-funcs-in-java/","content":"\n```java\n// Java Program to demonstrate Function Currying\n\nimport java.util.function.Function;\n\npublic class GFG {\n\tpublic static void main(String args[])\n\t{\n\n\t\t// Using Java 8 Functions\n\t\t// to create lambda expressions for functions\n\t\t// and with this, applying Function Currying\n\n\t\t// Curried Function for Multiplying u & v\n\t\tFunction<Integer,\n\t\t\t\tFunction<Integer, Integer> >\n\t\t\tcurryMulti = u -> v -> u * v;\n\n\t\t// Calling the curried functions\n\n\t\t// Calling Curried Function for Multiplying u & v\n\t\tSystem.out.println(\"Multiply 2, 3 :\"\n\t\t\t\t\t\t+ curryMulti\n\t\t\t\t\t\t\t\t.apply(2)\n\t\t\t\t\t\t\t\t.apply(3));\n\t}\n}\n```\n"},{"title":"Constructor Chaining","url":"/articles/2020/03/12/java/constructer-chaining/","content":"\nFollowing code demonstrates it:\n\n```java\nclass Test\n{\n    final public int i;\n\n    Test(int val)    {  this.i = val;  }\n\n    Test()\n    {\n        // Calling Test(int val)\n        this(10);\n    }\n\n    public static void main(String[] args)\n    {\n        Test t1 = new Test();\n        System.out.println(t1.i);\n\n        Test t2 = new Test(20);\n        System.out.println(t2.i);\n    }\n}\n```\n"},{"title":"Bounded Type Parameter","url":"/articles/2020/03/02/java/bounded-type-parameter-in-java/","content":"\n## Bounded Type\n\n```java\n// This class only accepts type parametes as any class\n// which extends class A or class A itself.\n// Passing any other type will cause compiler time error\n\n// LOOK AT ME!\nclass Bound<T extends A>\n{\n\n\tprivate T objRef;\n\n\tpublic Bound(T obj){\n\t\tthis.objRef = obj;\n\t}\n\n\tpublic void doRunTest(){\n\t\tthis.objRef.displayClass();\n\t}\n}\n\nclass A\n{\n\tpublic void displayClass()\n\t{\n\t\tSystem.out.println(\"Inside super class A\");\n\t}\n}\n\nclass B extends A\n{\n\tpublic void displayClass()\n\t{\n\t\tSystem.out.println(\"Inside sub class B\");\n\t}\n}\n\nclass C extends A\n{\n\tpublic void displayClass()\n\t{\n\t\tSystem.out.println(\"Inside sub class C\");\n\t}\n}\n\npublic class BoundedClass\n{\n\tpublic static void main(String a[])\n\t{\n\n\t\t// Creating object of sub class C and\n\t\t// passing it to Bound as a type parameter.\n\t\tBound<C> bec = new Bound<C>(new C());\n\t\tbec.doRunTest();\n\n\t\t// Creating object of sub class B and\n\t\t// passing it to Bound as a type parameter.\n\t\tBound<B> beb = new Bound<B>(new B());\n\t\tbeb.doRunTest();\n\n\t\t// similarly passing super class A\n\t\tBound<A> bea = new Bound<A>(new A());\n\t\tbea.doRunTest();\n\n\t}\n}\n```\n\n## Multiple Bound\n\n```java\n// LOOK AT ME!\nclass Bound<T extends A & B>\n{\n\n\tprivate T objRef;\n\n\tpublic Bound(T obj){\n\t\tthis.objRef = obj;\n\t}\n\n\tpublic void doRunTest(){\n\t\tthis.objRef.displayClass();\n\t}\n}\n\ninterface B\n{\n\tpublic void displayClass();\n}\n\nclass A implements B\n{\n\tpublic void displayClass()\n\t{\n\t\tSystem.out.println(\"Inside super class A\");\n\t}\n}\n\npublic class BoundedClass\n{\n\tpublic static void main(String a[])\n\t{\n\t\t//Creating object of sub class A and\n\t\t//passing it to Bound as a type parameter.\n\t\tBound<A> bea = new Bound<A>(new A());\n\t\tbea.doRunTest();\n\n\t}\n}\n```\n\n## Ref\n\n[bounded type parameter](https://www.geeksforgeeks.org/bounded-types-generics-java/)\n"},{"title":"Best Practice of Dokuwiki Workflow, Better Than OneNote","url":"/articles/2019/10/18/tutorial/dokuwiki-workflow/","content":"\n## Motivation\n\n[DokuWiki](https://www.dokuwiki.org/dokuwiki) is a powerful self-host wiki system. Content in a DokuWiki site is all static s.t. we can easily backup or restore our documents.\n\nI use DokuWiki a lot, and I prefer to write markdown files locally on my computer and then create a page on DokuWiki web page.\nHowever, this is not suitable for well-organized files and takes a lot of time, besides, I alwayse forget to upload the files or just can't remember which files are not on the cloud.\n\nSo I need an automation workflow to help me simplify jobs above.\n\nGit is the perfect tool for this situation, it's distributed and easy to control version of files. So I created a DokuWiki workflow based on Git.\n\n## Structure\n\n![Structure](https://latina-1253549750.cos.ap-shanghai.myqcloud.com/essay/imgs/20191018191649.png)\n\n## Setup a DokuWiki Site\n\nJust create a docker container and mount a `volume` where you put the persistent DokuWiki files.\n\n## Backup\n\nGenerally, after I established a DokuWiki site, I just initialize a repository in DokuWiki's root directory, known as `dokuwiki/` and regularly push it to GitHub and other git mirrors as a backup using `crontab`.\n\n## Write locally & Update Remotely\n\nThe core content of a DokuWiki is inside the directory of `dokuwiki/data/pages`, so just initialize another sub repository here and push it to GitHub. Then pull the git repository to your local computer, push to GitHub repository after you update the wiki.\n\nThe DokuWiki site needs to keep pace with local repository, so add another `crontab` job to pull the git repository.\n\nNotice that files in DokuWiki directory is owned by `daemon` by default, after `sudo git pull` the files are owned by `root`, that is, DokuWiki itself cannot modify them, in other words, you cannot edit the pages on DokuWiki webpage, which is just what we want it to be in order to prevent version conflict.\n\n### Suggested Tool Chain\n\nDokuWiki uses `.txt` files as pages, in order to treat them as markdown files, you need to put a `workplace` setting file `.vscode/settings.json` for vscode. The file content maybe following:\n\n```json\n{\n  \"files.associations\": {\n    \"*.txt\": \"markdown\"\n  },\n  \"workbench.colorTheme\": \"Dracula\",\n  \"[markdown]\": {\n    \"editor.quickSuggestions\": true,\n    \"editor.wordWrap\": \"on\"\n  }\n}\n```\n\nFor further info about vscode settings and code-snippets please read the official documentation of vscode.\n\nThanks for reading!\n"},{"title":"Integrate InfluxDB Service in GitLab CI","url":"/articles/2019/08/22/cicd/integrate-influxdb-service-in-gitlab-ci/","content":"\nThe services keyword defines a Docker image that runs during a job linked to the Docker image that the image keyword defines. This allows you to access the service image during build time.\n\nThe service image can run any application, but the most common use case is to run a database container, for example:\n\n- MySQL/PostgreSQL/SQLServer\n- Redis\n\nGitLab didn't provide an official document for InfluxDB, it still needs to configure though a `service` is just an image.\n\nAccording to [InfluxDB's official docker image](https://hub.docker.com/_/influxdb), we need to set a few envrionment variables, such as:\n\n- INFLUXDB_DB: for initializing db\n- INFLUXDB_ADMIN_USER: for write/read data, relies on the var above\n\nI add a service to a job, following `.gitlab-ci.yml` describes it:\n\n```yml\n# Execute via shell\nservices:\n  - name: influxdb:latest\nvariables:\n  INFLUXDB_DB: \"transaction_test\"\n  INFLUX_DB_HOST: \"http://localhost:8086\"\n# ...\n```\n\nHowever, `Connection Refused` errors occurred when I tried to dial TCP to `localhost` on port `8086` through shell executor in GitLab CI. Port `8086` is influxdb docker image's default HTTP API port.\nWhen defining a `mysql` or `redis` service, no port was described in yaml file, and I successfully connected to `mysql` service via\n`localhost:3306`. Is there any difference between these images?\n\nThe `mysql` image bind port `3306` by default, yet `influxdb` has not. Besides, GitLab does not support port mapping in CI `service`. There is an [issue](https://gitlab.com/gitlab-org/gitlab-runner/issues/2460) about port mapping in CI `service`, but it's still WIP after 2 years.\n\nTo debug, we can run our job on local gitlab-runner, and add `tail -F /dev/null` line before the part where our script fails, this will hault the job for 30 minutes. While it hangs, we can attach to the container wit `docker exec -it container-name /bin/sh` to see what happens. But I'd not try this.\n\nFinally, I found that the executor was randomly `Docker executor` and `Kubernetes executor`. The address is different in different executor.\nIn `Docker executor`, its own dns service will resolve the service name to a typical ip address. However in `K8S executor` you must link to the service via exact ip address, such as `localhost` or `127.0.0.1`.\n\nThen I just add a tag to the job, it works. GitLab CI will automatically publish the `EXPOSEd` port in the image's `Dockerfile`.\n\n```yml\ntags:\n  - kubernetes\n```\n"},{"title":"Hybrid Cloud Across IPsec VPN Tunnel","url":"/articles/2019/05/30/tutorial/hybrid-cloud-cross-ipsec-vpn/","content":"\n## Tutorial\n\n- Install IPsec VPN on public cloud machine.\n- Connect the router in LAN to the VPN.\n- Configurate gateway in the cloud machine.\n- Setup NGINX on the cloud machine.\n- Add server conf file to `/etc/nginx/sites-enabled/` and write it in your way.\n- Reload your NGINX server and visit the URL to see what happens.\n\n## NGINX Conf Demo\n\n```\nserver {\n        listen 80;\n        server_name api.contoso.com;\n        location / {\n                proxy_pass http://192.168.0.70:8848;\n                proxy_set_header Host $http_host;\n        }\n}\n```\n\n## Tips\n\n- Ubuntu saves your life not centOS.\n"},{"title":"Simple Reason Why Need to Avoid Side Effect","url":"/articles/2019/05/03/guide/simple-reason-why-need-to-avoid-side-effect/","content":"\n## Counterexample\n\nMoments ago I wrote a mutation function in a Vue.js project with side-effect, which means I'd mutated the params.\n\n```typescript\n// the mutation function at a glance\n[types.MUTATION_NAME](state: State, data: DataInterface) {\n  data.foo = newObject\n  data.bar = newObject\n  ...\n}\n```\n\nBesides, I `watch` the params passed to the mutation function in the component. Then a infinite loop occurred. ;(\n\nThat's why we need to avoid side effect, a simple reason.\n\n"},{"title":"Solve Pickle Issue When Using Function with Decorator in Multiprocessing","url":"/articles/2019/04/26/python/solve-multiprocessing-decorator-pickle-issue/","content":"\n## Issue\n\nExceptions raised below when I tried to use function with function decorator in multiprocessing.\n\n### My Decorator\n\n```python\ndef wrapped(retry=5, with_client=False):\n    def decorator(func):\n        @wraps\n        def wrapper(*args, **kwargs):\n            nonlocal retry\n            while True:\n                try:\n                    if with_client:\n                        client = InfluxDBClient(**kwargs['influx_option'])\n                        func(client, *args, **kwargs)\n                    else:\n                        func(*args, **kwargs)\n                except Queue.empty:\n                    time.sleep(1)\n                    if retry < 0:\n                        print('Exit {} after retry.'.format(func.__name__))\n                    retry -= 1\n                except Queue.full:\n                    time.sleep(1)\n                except Exception as e:\n                    print('Exception raised in {}'.format(func.__name__))\n                    print(str(e))\n                    time.sleep(1)\n        return wrapper\n    return decorator\n```\n\nI use this decorator function this way:\n\n```python\nfrom multiprocessing import Process\n# ...\n\n@wrapped(4)\nrun(arg):\n    pass\n\nProcess(target=run, args=('test',)).start()\n```\n\n### Errors\n\n```bash\n# 1st error\nAttributeError: Can't pickle local object 'wrapped.<locals>.decorator.<locals>.wrapper'\n\n# 2nd error\nEOFError: Ran out of input\n```\n\n## Solution\n\nThe reason this happens is that a wrapped function with function decorator is not `picklable`, which means the wrapped function is not serializable when passed to `Process()`, view [this blog](http://ralph-wang.github.io/blog/2015/02/15/zhuang-shi-qi-yu-duo-jin-cheng-yi-ji-pickle/)(language: zh-CN).\n\nYou can implement a decorator class to return a `picklable` object instead of decorator function.\n\n### My New Decorator\n\n```python\nclass Wrapped(object):\n    def __init__(self, retry=5, with_client=False):\n        self.retry = retry\n        self.with_client = with_client\n\n    def __call__(self, func):\n        @wraps(func)\n        def wrapper(*args, **kwargs):\n            while True:\n                try:\n                    if self.with_client:\n                        client = InfluxDBClient(**kwargs['influx_option'])\n                        func(client=client, *args, **kwargs)\n                    else:\n                        func(*args, **kwargs)\n                except Queue.empty:\n                    time.sleep(1)\n                    if retry < 0:\n                        print('Exit {} after retry.'.format(\n                            func.__name__\n                        ))\n                        break\n                    retry -= 1\n                except Queue.full:\n                    time.sleep(1)\n                except Exception as e:\n                    print('Exception raised in {}'.format(\n                        func.__name__\n                    ))\n                    print(str(e))\n                    time.sleep(1)\n        return wrapper\n```\n\nNow, we use the decorator class this way:\n\n```python\n\n@Wrapped(4, True)\nrun(arg):\n    pass\n\nProcess(target=run, args=(arg, ))\n```\n\n"},{"title":"Install Python on Windows the Easy Way","url":"/articles/2019/04/26/tutorial/install-python-the-easy-way/","content":"\n## Background\n\nThe sane way to manage software on Windows is using `Chocolatey`. It makes it possible and uncomplicated to install softwares automatically by just one command as easy as abc.\n\nBesides, it's open source and totally free for personal use. There are over 6500 community maintained packages on `Chocolatey` includes common softwares like Python, Adobe PDF Reader, Web Browsers and Anaconda.\n\nThe install process is smooth, just type a line of command and click `Enter`, you will have your well configured software installed after a cup of tea.\n\n## Steps\n\n### Install Chocolatey\n\n> Checkout this [official tutorial](https://chocolatey.org/install) for installing `Chocolatey`.\n\n1. Right click the Windows icon on bottom-left of your screen, and click `Powershell (as Admin)` option like below:\n\n![t1](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t1.png)\n\n1. When the User-Account-Control windows displays, click `Yes`.\n\n![t2](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t2.png)\n\n1. Paste the scripts below to the window:\n\n```Powershell\nSet-ExecutionPolicy Bypass -Scope Process -Force; iex ((New-Object System.Net.WebClient).DownloadString('https://chocolatey.org/install.ps1'))\n```\n\n![t3](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t3.png)\n\n1. Type `Enter`, when it finished, the window should be like below:\n\n![t4](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t4.png)\n\n1. Check the installation. Type `choco` or `choco -?`, if you get result like below, it means the installation is OK.\n\n![t5](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t5.png)\n\n1. Reboot your computer to activate some functionality of `Chocolatey`.\n\nDone!\n\n### Install Python\n\n#### Commands\n\nTry `choco -?` to see its brief introduction. In this case, you will use following commands:\n\n```cmd\nchoco list\nchoco search [software_name]\nchoco install [software_name1, software_name2, ..., software_nameN]\n```\n\nTo list local packages, type `choco list` on PowerShell.\n\nTo search specific software or package, e.g. Python, just type `choco search python`.\n\nTo install packages or softwares, e.g. Python and Anaconda, just type `choco install python3 python2 anaconda`\n\n#### Easy Way\n\nOpen your browser and go to [https://chocolatey.org/packages](https://chocolatey.org/packages).\n\nSearch the package you want.\n\n![t6](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t6.png)\n\nNow you get the available packages and installation command.\n\n![t7](https://seccdn.unoiou.com/img/articles/tutorial-install-chocolatey/t7.png)\n\nCopy the installation command and paste it to PowerShell window. Click `Enter` to run it.\n"},{"title":"Optimize InfluxDB Data Insertion","url":"/articles/2019/04/18/database/influxdb-insert-optimization/","content":"\n## Issue Description\n\nWe know that InfluxDB can query time series data more efficiently than SQL databases, but there are still some bugs when we insert or query data, they are:\n\n- SQL can return a result eventually even if it costs lots of time, but InfluxDB sometimes does return empty result set.\n- Data in InfluxDB might be lost and we can find it back by `backup & import`.\n- InfluxDB over Nginx or other HTTP server may encounter various problem such as `504 gateway time-out`.\n\nBesides, importing data to InfluxDB is really slow. UDP is fast, but it's not reliable for this case.\n\n## Solutions\n\nTo optimize the process of importing data, we can do these things.\n\n- Add more memory to your server.\n- Set the HTTP server's `time-out` and `max request size` to avoid `gateway timeout` or other HTTP server badcode.\n- Using agent server like Nginx will make double-transfer your data packet, because request data is first sent to Nginx, and Nginx will not transfer your request data until it take over the request body.\n- Do not split your request to batches as possible as you can.\n- Dump your data to import and not use HTTP request.\n\n"},{"title":"Fix WSL Vim Font Issue on Windows 10","url":"/articles/2019/04/18/time-wasting-stuff/fix-windows-wsl-vim-font-issue/","content":"\n## Issue\n\nAfter installed `Vim` on `wsl`, I found that the display font changed to `SimSun`(A very ugly font) when I open Vim.\n\nI tried to use `:set guifont font-name` but it didn't work at all, it annoyed me a lot. The hatred of Windows-fucking-bug-10 had seen absolute growth. :( What the fuck?!\n\n## Solution\n\nFourtunately, I found a solution by editing `Registry` on Windows 10.\n\n- Add a new `DWORD` record in `HKEY_CURRENT_USER\\Console\\C:_Program Files_WindowsApps_CanonicalGroupLimited.UbuntuonWindows_1804.2018.817.0_x64__79rhkp1fndgsc_ubuntu.exe` named `CodePage`\n- Set it to `Decimal` and value `65001` or `Hexadecimal` and value `fde9`\n- Restart the wsl window\n\nIt's fucking working now. Fuck! I do not judge Windows 10, but I've wasted a lot of time solving these sort of egg-painful things!\n\n## Once for All Solution\n\nCommand line on Windows is incurable, anything has done is just a waste of time. The best solution is just use [Cmder](https://cmder.net/) instead.\n\nBesides, I suggest you to use `zsh` instead of `Powershit`(`Powershell`) or `cnm`(`cmd`).\n\nAfter installed `zsh`, `oh-my-zsh` on your `WSL`, append following scripts to your `~/.bashrc` file.\n\n```bash\nbash -c zsh\n```\n\nAnd set `{WSL::bash}` as the default shell of `cmder`.\n\nNow enjoy your new fantastic terminal. :)\n\n"},{"title":"Fix Vim Red Background Color Issue on Windows WSL.","url":"/articles/2019/04/18/tutorial/fix-vim-bg-color-on-windows/","content":"\n## Issue\n\nThe color of blank space which is outside of the view turns red when I move my cursor to them.\n\nResize or reopen the Vim window can temporarily fix it.\n\n## Solution\n\nExport a variable called `TERM` can fix this issue permanently.\n\n```bash\nexport TERM=xterm+256colors\n```\n"},{"title":"Automatically Deploy Your Documents by Continuous Delivery","url":"/articles/2019/04/17/tutorial/articles-continuous-deployment/","content":"\nStatic sites generators such as Hexo, Jekyll, and Hugo etc. have save us from handling CSS/Javascript things. However, we still need to spend a lot of time to configurate generators and build our sites locally then publish/upload it to host.\n\nWith the help of continuous-integration platform, we may let the CI platform do the devil jobs. We just write markdowns, send them to the pipeline, then we are free to go.\n\nSo I started a project called [`Articles`](https://github.com/cmsax/articles), it can automatically build your articles on the cloud with continuous deployment.\n\nYou just concentrate on writing and never install `npm` or `Hexo` on your machine.\n\n`Articles` is enpowered by Hexo, `GitHub pages` and currently `Travis-CI`. You write the articles locally, and we build & publish your articles according your config.\n\nYou can find more information [here](https://github.com/cmsax/articles)\n"},{"title":"Our Solution to Electron Continuous Integration","url":"/articles/2018/07/06/cicd/electron-continuous-integration/","content":"\n## Background\n\nTDD and Auto DevOps recently have become popular for rapid iteration in small team.\n\nThough I am just a freshman in front-end development, I have to choose a suitable technology stack for our coming project called `Shannon`.\n\n## Solution\n\n### Stack\n\n- Electron for building cross-platform desktop app.\n- Electron-Vue as JS framework.\n- Spectron as Electron functional TestSuit.\n- Vue-test-utils as Vue components unit TestSuit.\n- GitLab, GitLab runner as CI-CD envrionment.\n- Kubernetes as backend.\n\n### Steps\n\n- Build a docker image for buiding and testing our app.\n- Create a `.gitlab-ci.yml` file to config our ci-cd tasks.\n- Write our test codes.\n- Write our app.\n- Improve our test code coverage.\n- Iteration.\n\n### Tips\n\nDependencies of a Docker image for running an Electron app:\n\n- Xvfb\n- wine32\n- node.js V8\n- npm or yarn\n\nThe image has been published to docker hub, you can pull it by:\n\n```bash\ndocker pull windworship/npm-image\n```\n\nDo not catch any exceptions in your test code.\n\n"}]